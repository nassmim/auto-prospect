{"version":3,"sources":["../../../../../../../../../../Projets/auto-prospect-worktrees/config/mono-repo/node_modules/.pnpm/next%4016.1.1_%40babel%2Bcore%407.28.6_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.2.3_react%4019.2.3__react%4019.2.3/node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../../../../../../../Projets/auto-prospect-worktrees/config/mono-repo/apps/web/src/lib/cache.config.ts","../../../../../../../../../../Projets/auto-prospect-worktrees/config/mono-repo/node_modules/.pnpm/next%4016.1.1_%40babel%2Bcore%407.28.6_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.2.3_react%4019.2.3__react%4019.2.3/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","../../../../../../../../../../Projets/auto-prospect-worktrees/config/mono-repo/apps/web/src/services/lead.service.ts","../../../../../../../../../../Projets/auto-prospect-worktrees/config/mono-repo/apps/web/src/services/hunt.service.ts","../../../../../../../../../../Projets/auto-prospect-worktrees/config/mono-repo/apps/web/src/services/dashboard.service.ts","../../../../../../../../../../Projets/auto-prospect-worktrees/config/mono-repo/apps/web/src/actions/dashboard.actions.ts"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","/**\n * Cache tag constants for consistent tagging across the application\n * Used with Next.js 16 'use cache' directive and updateTag()\n */\nexport const CACHE_TAGS = {\n  // Hunt configuration (without credits)\n  huntsByAccount: (accountId: string) => `hunts:${accountId}`,\n  hunt: (id: string) => `hunt:${id}`,\n\n  // Message templates\n  templatesByAccount: (accountId: string) => `templates:${accountId}`,\n\n  // Team members\n  teamMembersByAccount: (accountId: string) => `team-members:${accountId}`,\n\n  // Account-specific data\n  account: (id: string) => `account:${id}`,\n} as const;\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","import { createDrizzleSupabaseClient } from \"@/lib/db\";\nimport type { SQL, TDBQuery, TDBWithTokenClient } from \"@auto-prospect/db\";\nimport { and, eq, gte, leads, messages, sql } from \"@auto-prospect/db\";\nimport { ELeadStage } from \"@auto-prospect/shared/src/config/lead.config\";\n\ntype TLeadsSummaryStats = {\n  todayLeadsCount: number;\n  contactedLeadsCount: number;\n  totalLeads: number;\n};\n\n/**\n * Fetch complete lead details with all relations\n * Used by lead drawer and full page view\n */\nexport async function getLeadDetails(leadId: string) {\n  // This function can be cached\n  // Will be invalidated when the user performs an action on this specific lead\n  const dbClient = await createDrizzleSupabaseClient();\n\n  try {\n    // Fetch lead with all ad relations\n    const leadData = await dbClient.rls(async (tx) => {\n      return tx.query.leads.findFirst({\n        where: eq(leads.id, leadId),\n        with: {\n          ad: {\n            with: {\n              brand: true,\n              fuel: true,\n              gearBox: true,\n              location: true,\n              type: true,\n              subtype: true,\n              vehicleState: true,\n              vehicleSeats: true,\n              drivingLicence: true,\n            },\n          },\n          assignedTo: {\n            columns: {\n              id: true,\n              name: true,\n            },\n          },\n          notes: {\n            orderBy: (notes, { desc }) => [desc(notes.createdAt)],\n          },\n          reminders: {\n            orderBy: (reminders, { asc }) => [asc(reminders.dueAt)],\n          },\n        },\n      });\n    });\n\n    if (!leadData) {\n      throw new Error(\"Lead not found\");\n    }\n\n    return leadData;\n  } catch (error) {\n    console.error(\"Error fetching lead details:\", error);\n    throw new Error(\"Failed to fetch lead details\");\n  }\n}\n\n/**\n * Fetch all members of the lead's account for assignment dropdown\n */\nexport async function getLeadAssociatedTeamMembers(leadId: string) {\n  // This function can be cached\n  // Will be invalidated when the user associates another member or removes the member association\n  const dbClient = await createDrizzleSupabaseClient();\n\n  try {\n    // First, get the lead's account\n    const lead = await dbClient.rls((tx) =>\n      tx.query.leads.findFirst({\n        where: eq(leads.id, leadId),\n        columns: {\n          accountId: true,\n        },\n      }),\n    );\n\n    if (!lead) {\n      throw new Error(\"Lead not found\");\n    }\n\n    // Fetch all members of this account\n    return await dbClient.rls((tx) =>\n      tx.query.teamMembers.findMany({\n        where: (table, { eq }) => eq(table.accountId, lead.accountId),\n      }),\n    );\n  } catch {\n    throw new Error(\"Failed to fetch account members\");\n  }\n}\n\n/**\n * Fetch message history for a lead\n */\nexport async function getLeadMessages(leadId: string) {\n  // This function can be cached\n  // Will be invalidated when the user sends a new message to this lead\n  const dbClient = await createDrizzleSupabaseClient();\n\n  try {\n    const messagesList = await dbClient.rls(async (tx) => {\n      return tx.query.messages.findMany({\n        where: eq(messages.leadId, leadId),\n        with: {\n          sentBy: {\n            columns: {\n              id: true,\n              name: true,\n            },\n          },\n        },\n        orderBy: (table, { desc }) => [desc(table.sentAt)],\n      });\n    });\n\n    return messagesList;\n  } catch {\n    throw new Error(\"Failed to fetch messages\");\n  }\n}\n\n/**\n * Fetch activity timeline for a lead\n */\nexport async function getLeadActivities(leadId: string) {\n  const dbClient = await createDrizzleSupabaseClient();\n\n  try {\n    const activitiesList = await dbClient.rls(async (tx) => {\n      return tx.query.leadActivities.findMany({\n        where: (table, { eq }) => eq(table.leadId, leadId),\n        with: {\n          lead: {\n            with: {\n              assignedTo: {\n                columns: {\n                  id: true,\n                  name: true,\n                },\n              },\n            },\n          },\n        },\n        orderBy: (table, { desc }) => [desc(table.createdAt)],\n      });\n    });\n\n    return activitiesList;\n  } catch {\n    throw new Error(\"Failed to fetch activities\");\n  }\n}\n\n/**\n * Fetches leads acquired today\n */\nexport async function getTodayNewLeads(options?: {\n  huntId?: string;\n  dbClient?: TDBWithTokenClient;\n  tx?: TDBQuery;\n}): Promise<{ todayLeadsCount: number }> {\n  const { huntId, dbClient, tx } = options || {};\n\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n\n  // Build where conditions dynamically based on whether huntId is provided\n  const whereConditions = [gte(leads.createdAt, today)];\n\n  if (huntId) {\n    whereConditions.push(eq(leads.huntId, huntId));\n  }\n\n  // If transaction provided, use it directly; otherwise create new RLS transaction\n  if (tx) {\n    const todayLeads = await tx\n      .select({ count: sql<number>`cast(count(*) as integer)` })\n      .from(leads)\n      .where(and(...whereConditions));\n\n    return {\n      todayLeadsCount: todayLeads[0]?.count ?? 0,\n    };\n  }\n\n  const client = dbClient || (await createDrizzleSupabaseClient());\n  const todayLeads = await client.rls(async (tx) =>\n    tx\n      .select({ count: sql<number>`cast(count(*) as integer)` })\n      .from(leads)\n      .where(and(...whereConditions)),\n  );\n\n  return {\n    todayLeadsCount: todayLeads[0]?.count ?? 0,\n  };\n}\n\n/**\n * Fetches the number of leads contacted\n */\nexport async function getContactedLeads(options?: {\n  huntId?: string;\n  dbClient?: TDBWithTokenClient;\n  tx?: TDBQuery;\n}): Promise<{ contactedLeadsCount: number }> {\n  const { huntId, dbClient, tx } = options || {};\n\n  // Build where conditions dynamically based on whether huntId is provided\n  const whereConditions = [eq(leads.stage, ELeadStage.CONTACTED)];\n\n  if (huntId) {\n    whereConditions.push(eq(leads.huntId, huntId));\n  }\n\n  // If transaction provided, use it directly; otherwise create new RLS transaction\n  if (tx) {\n    const contactedLeads = await tx\n      .select({ count: sql<number>`cast(count(*) as integer)` })\n      .from(leads)\n      .where(and(...whereConditions));\n\n    return {\n      contactedLeadsCount: contactedLeads[0]?.count ?? 0,\n    };\n  }\n\n  const client = dbClient || (await createDrizzleSupabaseClient());\n  const contactedLeads = await client.rls(async (tx) =>\n    tx\n      .select({ count: sql<number>`cast(count(*) as integer)` })\n      .from(leads)\n      .where(and(...whereConditions)),\n  );\n\n  return {\n    contactedLeadsCount: contactedLeads[0]?.count ?? 0,\n  };\n}\n\n/**\n * Fetches the total number of leads\n */\nexport async function getTotalLeads(options?: {\n  huntId?: string;\n  dbClient?: TDBWithTokenClient;\n  tx?: TDBQuery;\n}): Promise<{ totalLeads: number }> {\n  const { huntId, dbClient, tx } = options || {};\n\n  // Build where conditions dynamically based on whether huntId is provided\n  let whereConditions: SQL<unknown> | undefined;\n  if (huntId) whereConditions = eq(leads.huntId, huntId);\n\n  // If transaction provided, use it directly; otherwise create new RLS transaction\n  if (tx) {\n    const totalLeads = await tx\n      .select({ count: sql<number>`cast(count(*) as integer)` })\n      .from(leads)\n      .where(whereConditions);\n\n    return {\n      totalLeads: totalLeads[0]?.count ?? 0,\n    };\n  }\n\n  const client = dbClient || (await createDrizzleSupabaseClient());\n  const totalLeads = await client.rls(async (tx) =>\n    tx\n      .select({ count: sql<number>`cast(count(*) as integer)` })\n      .from(leads)\n      .where(whereConditions),\n  );\n\n  return {\n    totalLeads: totalLeads[0]?.count ?? 0,\n  };\n}\n\n/**\n * Fetches summary statistics for leads\n * @param huntId - Optional hunt ID to filter by specific hunt. If not provided, returns global stats for all hunts.\n */\nexport async function getLeadsSummaryStats(\n  huntId?: string,\n): Promise<TLeadsSummaryStats> {\n  const dbClient = await createDrizzleSupabaseClient();\n\n  const summaryStats = await Promise.all([\n    getTodayNewLeads({ huntId, dbClient }),\n    getContactedLeads({ huntId, dbClient }),\n    getTotalLeads({ huntId, dbClient }),\n  ]);\n\n  return {\n    todayLeadsCount: summaryStats[0].todayLeadsCount,\n    contactedLeadsCount: summaryStats[1].contactedLeadsCount,\n    totalLeads: summaryStats[2].totalLeads,\n  };\n}\n\n/**\n * Fetches all leads for the pipeline/kanban view with minimal ad details\n * Returns leads grouped for easy rendering in Kanban columns\n */\nexport async function getPipelineLeads() {\n  const dbClient = await createDrizzleSupabaseClient();\n\n  const pipelineLeads = await dbClient.rls(async (tx) => {\n    const rawLeads = await tx.query.leads.findMany({\n      orderBy: (table, { asc }) => [asc(table.stage), asc(table.position)],\n      with: {\n        ad: {\n          columns: {\n            id: true,\n            title: true,\n            price: true,\n            picture: true,\n            phoneNumber: true,\n            isWhatsappPhone: true,\n          },\n          with: {\n            location: {\n              columns: {\n                name: true,\n              },\n            },\n          },\n        },\n      },\n    });\n\n    // Transform to match KanbanView expected structure\n    return rawLeads.map((lead) => ({\n      id: lead.id,\n      stage: lead.stage,\n      position: lead.position,\n      ad: {\n        title: lead.ad.title,\n        price: lead.ad.price,\n        picture: lead.ad.picture,\n        phoneNumber: lead.ad.phoneNumber,\n        isWhatsappPhone: lead.ad.isWhatsappPhone,\n        zipcode: {\n          name: lead.ad.location.name,\n        },\n      },\n    }));\n  });\n\n  return pipelineLeads;\n}\n\nexport type TPipelineLead = Awaited<\n  ReturnType<typeof getPipelineLeads>\n>[number];\n","import { CACHE_TAGS } from \"@/lib/cache.config\";\nimport { createDrizzleSupabaseClient } from \"@/lib/db\";\nimport { getUserAccount } from \"@/services/account.service\";\nimport { getContactedLeads, getTotalLeads } from \"@/services/lead.service\";\nimport { TDBWithTokenClient } from \"@auto-prospect/db\";\nimport { HUNT_WITH_RELATIONS, THuntSummary } from \"@auto-prospect/shared\";\nimport { EHuntStatus } from \"@auto-prospect/shared/src/config/hunt.config\";\nimport { cacheTag, updateTag } from \"next/cache\";\n\n/**\n * Fetches hunt configurations (without credits) - CACHED\n * This is the cached version that only returns hunt config\n */\nexport async function getAccountHuntsConfig() {\n  const dbClient = await createDrizzleSupabaseClient();\n  const account = await getUserAccount(dbClient, {\n    columnsToKeep: { id: true },\n  });\n  return getCachedAccountHuntsConfig(account.id, dbClient);\n}\n\n/**\n * Internal cached function for hunt configurations\n */\nasync function getCachedAccountHuntsConfig(\n  accountId: string,\n  dbClient?: TDBWithTokenClient,\n) {\n  \"use cache\";\n\n  cacheTag(CACHE_TAGS.huntsByAccount(accountId));\n\n  const client = dbClient || (await createDrizzleSupabaseClient());\n\n  // Use RLS wrapper to ensure user can only see their account's hunts\n  const huntsData = await client.rls(async (tx) => {\n    return tx.query.hunts.findMany({\n      orderBy: (table, { desc }) => [desc(table.createdAt)],\n      with: HUNT_WITH_RELATIONS,\n    });\n  });\n\n  return huntsData;\n}\n\n/**\n * Fetches channel credits for multiple hunts - NOT CACHED\n * Called separately when credit display is needed\n */\nexport async function getHuntsChannelCredits(huntIds: string[]) {\n  const dbClient = await createDrizzleSupabaseClient();\n\n  const allChannelCredits = await dbClient.rls(async (tx) => {\n    return tx.query.huntChannelCredits.findMany({\n      where: (table, { inArray }) => inArray(table.huntId, huntIds),\n    });\n  });\n\n  // Group credits by hunt ID\n  const creditsByHuntId = new Map<string, typeof allChannelCredits>();\n  for (const credit of allChannelCredits) {\n    if (!creditsByHuntId.has(credit.huntId)) {\n      creditsByHuntId.set(credit.huntId, []);\n    }\n    creditsByHuntId.get(credit.huntId)!.push(credit);\n  }\n\n  return creditsByHuntId;\n}\n\n/**\n * Fetches all hunts for the current user's account with channel credits\n * Combines cached config with fresh credits\n */\nexport async function getAccountHunts() {\n  // Get cached hunt configs\n  const huntsData = await getAccountHuntsConfig();\n\n  if (huntsData.length === 0) {\n    return [];\n  }\n\n  // Fetch fresh channel credits\n  const huntIds = huntsData.map(({ id }) => id);\n  const creditsByHuntId = await getHuntsChannelCredits(huntIds);\n\n  // Attach credits to each hunt\n  return huntsData.map((hunt) => ({\n    ...hunt,\n    channelCredits: creditsByHuntId.get(hunt.id) || [],\n  }));\n}\n\n/**\n * Fetches hunt config by ID (without credits) - CACHED\n */\nexport async function getHuntConfigById(huntId: string) {\n  const dbClient = await createDrizzleSupabaseClient();\n  const account = await getUserAccount(dbClient, {\n    columnsToKeep: { id: true },\n  });\n  return getCachedHuntConfigById(huntId, account.id, dbClient);\n}\n\n/**\n * Internal cached function for single hunt config\n */\nasync function getCachedHuntConfigById(\n  huntId: string,\n  accountId: string,\n  dbClient?: TDBWithTokenClient,\n) {\n  \"use cache\";\n\n  cacheTag(CACHE_TAGS.hunt(huntId), CACHE_TAGS.huntsByAccount(accountId));\n\n  const client = dbClient || (await createDrizzleSupabaseClient());\n\n  const hunt = await client.rls(async (tx) => {\n    return tx.query.hunts.findFirst({\n      where: (table, { eq }) => eq(table.id, huntId),\n      with: HUNT_WITH_RELATIONS,\n    });\n  });\n\n  if (!hunt) {\n    throw new Error(\"hunt not found\");\n  }\n\n  return hunt;\n}\n\n/**\n * Fetches a single hunt by ID with channel credits\n * Combines cached config with fresh credits\n */\nexport async function getHuntById(huntId: string) {\n  // Get cached hunt config\n  const hunt = await getHuntConfigById(huntId);\n\n  // Fetch fresh channel credits\n  const dbClient = await createDrizzleSupabaseClient();\n  const channelCreditsData = await dbClient.rls(async (tx) => {\n    return tx.query.huntChannelCredits.findMany({\n      where: (table, { eq }) => eq(table.huntId, huntId),\n    });\n  });\n\n  return {\n    ...hunt,\n    channelCredits: channelCreditsData,\n  };\n}\n\n/**\n * Fetches active hunts with summary data for dashboard\n */\nexport async function getActiveHunts(): Promise<THuntSummary[]> {\n  const dbClient = await createDrizzleSupabaseClient();\n\n  const hunts = await dbClient.rls(async (tx) => {\n    // Fetch hunts with lead counts\n    const huntsData = await tx.query.hunts.findMany({\n      where: (table, { eq }) => eq(table.status, EHuntStatus.ACTIVE),\n      orderBy: (table, { desc }) => [\n        desc(table.lastScanAt),\n        desc(table.createdAt),\n      ],\n      limit: 10, // Show top 10 active hunts\n    });\n\n    // Get lead counts for each hunt - pass transaction to avoid nested RLS calls\n    const huntSummaries: THuntSummary[] = await Promise.all(\n      huntsData.map(async (hunt) => {\n        const [{ totalLeads }, { contactedLeadsCount }] = await Promise.all([\n          getTotalLeads({ huntId: hunt.id, tx }),\n          getContactedLeads({ huntId: hunt.id, tx }),\n        ]);\n\n        return {\n          id: hunt.id,\n          name: hunt.name,\n          status: hunt.status,\n          leadCount: totalLeads,\n          contactedCount: contactedLeadsCount,\n          lastScanAt: hunt.lastScanAt,\n          createdAt: hunt.createdAt,\n        };\n      }),\n    );\n\n    return huntSummaries;\n  });\n\n  return hunts;\n}\n\nexport const updateAccountHuntsCache = async (\n  dbClient: TDBWithTokenClient,\n  huntId?: string,\n  accountId?: string,\n) => {\n  let accountIdToUse = accountId;\n  if (!accountIdToUse) {\n    const account = await getUserAccount(dbClient, {\n      columnsToKeep: { id: true },\n    });\n    accountIdToUse = account.id;\n  }\n\n  updateTag(CACHE_TAGS.huntsByAccount(accountIdToUse));\n  if (huntId) updateTag(CACHE_TAGS.hunt(huntId));\n};\n","import { createDrizzleSupabaseClient } from \"@/lib/db\";\nimport { getContactedLeads, getTodayNewLeads } from \"@/services/lead.service\";\nimport { eq, messages, sql } from \"@auto-prospect/db\";\nimport {\n  EContactChannel,\n  TContactChannel,\n} from \"@auto-prospect/shared/src/config/message.config\";\n\n/**\n * Dashboard statistics for the account\n */\ntype TDashboardStats = {\n  newLeadsToday: number;\n  leadsContacted: number;\n  messagesSentByChannel: Record<TContactChannel, number>;\n};\n\n/**\n * Fetches dashboard statistics for the current user's account\n * Aggregates: today's new leads, contacted leads, and messages by channel\n */\nexport async function getDashboardStats(): Promise<TDashboardStats> {\n  const dbClient = await createDrizzleSupabaseClient();\n\n  // Fetch lead stats and message stats in parallel (independent queries)\n  const [leadStats, messageStats] = await Promise.all([\n    // Lead stats in one RLS transaction\n    dbClient.rls(async (tx) => {\n      const [todayLeads, contactedLeads] = await Promise.all([\n        getTodayNewLeads({ tx }),\n        getContactedLeads({ tx }),\n      ]);\n\n      return {\n        newLeadsToday: todayLeads.todayLeadsCount,\n        leadsContacted: contactedLeads.contactedLeadsCount,\n      };\n    }),\n\n    // Message counts in separate RLS transaction\n    dbClient.rls(async (tx) => {\n      // Count messages for each channel in parallel\n      const channels = [\n        EContactChannel.WHATSAPP_TEXT,\n        EContactChannel.SMS,\n        EContactChannel.RINGLESS_VOICE,\n      ] as const;\n\n      const channelCounts = await Promise.all(\n        channels.map(async (channel) => {\n          const result = await tx\n            .select({ count: sql<number>`cast(count(*) as integer)` })\n            .from(messages)\n            .where(eq(messages.channel, channel));\n\n          return { channel, count: result[0]?.count ?? 0 };\n        }),\n      );\n\n      // Transform array to object\n      return channelCounts.reduce(\n        (acc, { channel, count }) => {\n          acc[channel] = count;\n          return acc;\n        },\n        {} as Record<TContactChannel, number>,\n      );\n    }),\n  ]);\n\n  return {\n    ...leadStats,\n    messagesSentByChannel: messageStats,\n  };\n}\n","\"use server\";\n\nimport { getDashboardStats } from \"@/services/dashboard.service\";\nimport { getActiveHunts } from \"@/services/hunt.service\";\n\n/**\n * Fetches dashboard statistics for the current user's account\n * Server action wrapper for SWR client-side fetching\n */\nexport async function fetchDashboardStats() {\n  return getDashboardStats();\n}\n\n/**\n * Fetches active hunts with summary data for dashboard\n * Server action wrapper for SWR client-side fetching\n */\nexport async function fetchActiveHunts() {\n  return getActiveHunts();\n}\n"],"names":["registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"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","ignoreList":[0,2]}