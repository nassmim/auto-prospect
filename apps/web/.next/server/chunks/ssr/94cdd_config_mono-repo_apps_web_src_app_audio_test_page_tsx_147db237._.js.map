{"version":3,"sources":["../../../../../../../../../../Projets/auto-prospect-worktrees/config/mono-repo/apps/web/src/hooks/useAudioRecorder.ts","../../../../../../../../../../Projets/auto-prospect-worktrees/config/mono-repo/apps/web/src/app/audio/test/page.tsx"],"sourcesContent":["import { useState, useRef, useCallback } from \"react\";\n\ntype UseAudioRecorderReturn = {\n  isRecording: boolean;\n  audioUrl: string | null;\n  error: string | null;\n  startRecording: () => Promise<void>;\n  stopRecording: () => void;\n  resetRecording: () => void;\n};\n\nexport function useAudioRecorder(): UseAudioRecorderReturn {\n  const [isRecording, setIsRecording] = useState(false);\n  const [audioUrl, setAudioUrl] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\n  const chunksRef = useRef<Blob[]>([]);\n  const streamRef = useRef<MediaStream | null>(null);\n\n  const startRecording = useCallback(async () => {\n    setError(null);\n    setAudioUrl(null);\n\n    try {\n      // Request microphone access\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      streamRef.current = stream;\n\n      // Create MediaRecorder\n      const mediaRecorder = new MediaRecorder(stream);\n      mediaRecorderRef.current = mediaRecorder;\n      chunksRef.current = [];\n\n      // Collect audio chunks\n      mediaRecorder.ondataavailable = (event) => {\n        if (event.data.size > 0) {\n          chunksRef.current.push(event.data);\n        }\n      };\n\n      // When recording stops, create audio URL\n      mediaRecorder.onstop = () => {\n        const blob = new Blob(chunksRef.current, { type: \"audio/webm\" });\n        const url = URL.createObjectURL(blob);\n        setAudioUrl(url);\n\n        // Stop all tracks to release microphone\n        if (streamRef.current) {\n          streamRef.current.getTracks().forEach((track) => track.stop());\n        }\n      };\n\n      // Start recording\n      mediaRecorder.start();\n      setIsRecording(true);\n    } catch (err) {\n      setError(\n        err instanceof Error\n          ? err.message\n          : \"Impossible d'accÃ©der au microphone\"\n      );\n    }\n  }, []);\n\n  const stopRecording = useCallback(() => {\n    if (mediaRecorderRef.current && isRecording) {\n      mediaRecorderRef.current.stop();\n      setIsRecording(false);\n    }\n  }, [isRecording]);\n\n  const resetRecording = useCallback(() => {\n    setAudioUrl(null);\n    setError(null);\n    chunksRef.current = [];\n  }, []);\n\n  return {\n    isRecording,\n    audioUrl,\n    error,\n    startRecording,\n    stopRecording,\n    resetRecording,\n  };\n}\n","\"use client\";\n\nimport { useAudioRecorder } from \"@/hooks/useAudioRecorder\";\n\nexport default function AudioRecorderTestPage() {\n  const {\n    isRecording,\n    audioUrl,\n    error,\n    startRecording,\n    stopRecording,\n    resetRecording,\n  } = useAudioRecorder();\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-6\">\n      <div className=\"mx-auto max-w-md\">\n        <h1 className=\"mb-6 text-xl font-semibold text-gray-900\">\n          Test Enregistrement Audio\n        </h1>\n\n        <div className=\"rounded-xl border border-gray-200 bg-white p-6\">\n          {/* Error message */}\n          {error && (\n            <div className=\"mb-4 rounded-lg bg-red-50 p-3 text-sm text-red-700\">\n              {error}\n            </div>\n          )}\n\n          {/* Recording controls */}\n          <div className=\"flex justify-center gap-4\">\n            {!isRecording ? (\n              <button\n                onClick={startRecording}\n                className=\"flex items-center gap-2 rounded-lg bg-red-600 px-6 py-3 font-medium text-white hover:bg-red-700\"\n              >\n                <span className=\"h-3 w-3 rounded-full bg-white\"></span>\n                Enregistrer\n              </button>\n            ) : (\n              <button\n                onClick={stopRecording}\n                className=\"flex items-center gap-2 rounded-lg bg-gray-900 px-6 py-3 font-medium text-white hover:bg-gray-800\"\n              >\n                <span className=\"h-3 w-3 bg-white\"></span>\n                Stop\n              </button>\n            )}\n          </div>\n\n          {/* Recording indicator */}\n          {isRecording && (\n            <div className=\"mt-4 flex items-center justify-center gap-2 text-red-600\">\n              <span className=\"h-2 w-2 animate-pulse rounded-full bg-red-600\"></span>\n              Enregistrement en cours...\n            </div>\n          )}\n\n          {/* Audio playback */}\n          {audioUrl && (\n            <div className=\"mt-6\">\n              <div className=\"mb-2 flex items-center justify-between\">\n                <p className=\"text-sm font-medium text-gray-700\">Lecture :</p>\n                <button\n                  onClick={resetRecording}\n                  className=\"text-sm text-gray-500 hover:text-gray-700\"\n                >\n                  Supprimer\n                </button>\n              </div>\n              <audio controls src={audioUrl} className=\"w-full\" />\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}