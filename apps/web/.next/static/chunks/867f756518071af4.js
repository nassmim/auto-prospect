(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18116,e=>{"use strict";let t;var r,n,a,l,i,s,o,c,d,u,h,f,m,g,p,x,b,v,w,y=e.i(4386),j=e.i(57080);let N=(0,j.createServerReference)("0005bc12ba53c44da372d8a38ac6ef55306543beb5",j.callServer,void 0,j.findSourceMapURL,"fetchPipelineLeads"),k=(0,j.createServerReference)("601dde30ce0c9cae3cb7403002e4122bd509201b08",j.callServer,void 0,j.findSourceMapURL,"updateLeadStage");var S=e.i(43213),z=e.i(67544);let D=[{key:"NEW",value:"new",label:"Nouveau",description:"Leads nouvellement découverts",color:"#3b82f6",class:"bg-blue-900/30 text-blue-400 border-blue-900/50",icon:"star"},{key:"CONTACTED",value:"contacted",label:"Contacté",description:"Premier contact établi",color:"#8b5cf6",class:"bg-purple-900/30 text-purple-400 border-purple-900/50",icon:"message"},{key:"CHASED",value:"chased",label:"Relance",description:"En attente de réponse",color:"#f59e0b",class:"bg-orange-900/30 text-orange-400 border-orange-900/50",icon:"clock"},{key:"WON",value:"won",label:"Gagné",description:"Vente conclue",color:"#22c55e",class:"bg-green-900/30 text-green-400 border-green-900/50",icon:"check"},{key:"LOST",value:"lost",label:"Perdu",description:"Opportunité perdue",color:"#ef4444",class:"bg-red-900/30 text-red-400 border-red-900/50",icon:"x"}];Object.fromEntries(D.map(e=>[e.key,e.value]));let C=D.map(e=>e.value),M=e=>{let t=D.find(t=>t.value===e);if(!t)throw Error(`Invalid lead stage: ${e}`);return t},E=[{key:"STAGE_CHANGE",value:"stage_change",label:"Changement d'étape",description:"Le lead a changé d'étape",icon:"arrow-right",color:"blue"},{key:"MESSAGE_SENT",value:"message_sent",label:"Message envoyé",description:"Un message a été envoyé au lead",icon:"send",color:"green"},{key:"ASSIGNMENT_CHANGE",value:"assignment_change",label:"Changement d'assignation",description:"Le lead a été assigné à un autre utilisateur",icon:"user",color:"purple"},{key:"NOTE_ADDED",value:"note_added",label:"Note ajoutée",description:"Une note a été ajoutée au lead",icon:"file-text",color:"orange"},{key:"REMINDER_SET",value:"reminder_set",label:"Rappel défini",description:"Un rappel a été créé",icon:"bell",color:"yellow"},{key:"CREATED",value:"created",label:"Créé",description:"Le lead a été créé",icon:"plus",color:"gray"}];Object.fromEntries(E.map(e=>[e.key,e.value])),E.map(e=>e.value);var L=e.i(17902),R=e.i(56629);let T="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function O(e){let t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function F(e){return"nodeType"in e}function P(e){var t,r;return e?O(e)?e:F(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function A(e){let{Document:t}=P(e);return e instanceof t}function B(e){return!O(e)&&e instanceof P(e).HTMLElement}function W(e){return e instanceof P(e).SVGElement}function Y(e){return e?O(e)?e.document:F(e)?A(e)?e:B(e)||W(e)?e.ownerDocument:document:document:document}let I=T?L.useLayoutEffect:L.useEffect;function H(e){let t=(0,L.useRef)(e);return I(()=>{t.current=e}),(0,L.useCallback)(function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return null==t.current?void 0:t.current(...r)},[])}function U(e,t){void 0===t&&(t=[e]);let r=(0,L.useRef)(e);return I(()=>{r.current!==e&&(r.current=e)},t),r}function q(e,t){let r=(0,L.useRef)();return(0,L.useMemo)(()=>{let t=e(r.current);return r.current=t,t},[...t])}function $(e){let t=H(e),r=(0,L.useRef)(null),n=(0,L.useCallback)(e=>{e!==r.current&&(null==t||t(e,r.current)),r.current=e},[]);return[r,n]}function X(e){let t=(0,L.useRef)();return(0,L.useEffect)(()=>{t.current=e},[e]),t.current}let K={};function G(e,t){return(0,L.useMemo)(()=>{if(t)return t;let r=null==K[e]?0:K[e]+1;return K[e]=r,e+"-"+r},[e,t])}function V(e){return function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.reduce((t,r)=>{for(let[n,a]of Object.entries(r)){let r=t[n];null!=r&&(t[n]=r+e*a)}return t},{...t})}}let _=V(1),Q=V(-1);function J(e){if(!e)return!1;let{KeyboardEvent:t}=P(e.target);return t&&e instanceof t}function Z(e){if(function(e){if(!e)return!1;let{TouchEvent:t}=P(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){let{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){let{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return"clientX"in e&&"clientY"in e?{x:e.clientX,y:e.clientY}:null}let ee=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[ee.Translate.toString(e),ee.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),et="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]",er={display:"none"};function en(e){let{id:t,value:r}=e;return L.default.createElement("div",{id:t,style:er},r)}function ea(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;return L.default.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":n,"aria-atomic":!0},r)}let el=(0,L.createContext)(null),ei={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},es={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function eo(e){var t;let r,{announcements:n=es,container:a,hiddenTextDescribedById:l,screenReaderInstructions:i=ei}=e,{announce:s,announcement:o}=function(){let[e,t]=(0,L.useState)("");return{announce:(0,L.useCallback)(e=>{null!=e&&t(e)},[]),announcement:e}}(),c=G("DndLiveRegion"),[d,u]=(0,L.useState)(!1);if((0,L.useEffect)(()=>{u(!0)},[]),t=(0,L.useMemo)(()=>({onDragStart(e){let{active:t}=e;s(n.onDragStart({active:t}))},onDragMove(e){let{active:t,over:r}=e;n.onDragMove&&s(n.onDragMove({active:t,over:r}))},onDragOver(e){let{active:t,over:r}=e;s(n.onDragOver({active:t,over:r}))},onDragEnd(e){let{active:t,over:r}=e;s(n.onDragEnd({active:t,over:r}))},onDragCancel(e){let{active:t,over:r}=e;s(n.onDragCancel({active:t,over:r}))}}),[s,n]),r=(0,L.useContext)(el),(0,L.useEffect)(()=>{if(!r)throw Error("useDndMonitor must be used within a children of <DndContext>");return r(t)},[t,r]),!d)return null;let h=L.default.createElement(L.default.Fragment,null,L.default.createElement(en,{id:l,value:i.draggable}),L.default.createElement(ea,{id:c,announcement:o}));return a?(0,R.createPortal)(h,a):h}function ec(){}function ed(e,t){return(0,L.useMemo)(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}(r=u||(u={})).DragStart="dragStart",r.DragMove="dragMove",r.DragEnd="dragEnd",r.DragCancel="dragCancel",r.DragOver="dragOver",r.RegisterDroppable="registerDroppable",r.SetDroppableDisabled="setDroppableDisabled",r.UnregisterDroppable="unregisterDroppable";let eu=Object.freeze({x:0,y:0});function eh(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function ef(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function em(e){let{left:t,top:r,height:n,width:a}=e;return[{x:t,y:r},{x:t+a,y:r},{x:t,y:r+n},{x:t+a,y:r+n}]}let eg=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,a=em(t),l=[];for(let e of n){let{id:t}=e,n=r.get(t);if(n){let r=em(n),i=Number((a.reduce((e,t,n)=>{var a;return e+(a=r[n],Math.sqrt(Math.pow(a.x-t.x,2)+Math.pow(a.y-t.y,2)))},0)/4).toFixed(4));l.push({id:t,data:{droppableContainer:e,value:i}})}}return l.sort(eh)},ep=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,a=[];for(let e of n){let{id:n}=e,l=r.get(n);if(l){let r=function(e,t){let r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),l=Math.min(t.top+t.height,e.top+e.height);if(n<a&&r<l){let i=t.width*t.height,s=e.width*e.height,o=(a-n)*(l-r);return Number((o/(i+s-o)).toFixed(4))}return 0}(l,t);r>0&&a.push({id:n,data:{droppableContainer:e,value:r}})}}return a.sort(ef)};function ex(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:eu}let eb=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((e,t)=>({...e,top:e.top+ +t.y,bottom:e.bottom+ +t.y,left:e.left+ +t.x,right:e.right+ +t.x}),{...e})};function ev(e){if(e.startsWith("matrix3d(")){let t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){let t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}let ew={ignoreTransform:!1};function ey(e,t){void 0===t&&(t=ew);let r=e.getBoundingClientRect();if(t.ignoreTransform){let{transform:t,transformOrigin:n}=P(e).getComputedStyle(e);t&&(r=function(e,t,r){let n=ev(t);if(!n)return e;let{scaleX:a,scaleY:l,x:i,y:s}=n,o=e.left-i-(1-a)*parseFloat(r),c=e.top-s-(1-l)*parseFloat(r.slice(r.indexOf(" ")+1)),d=a?e.width/a:e.width,u=l?e.height/l:e.height;return{width:d,height:u,top:c,right:o+d,bottom:c+u,left:o}}(r,t,n))}let{top:n,left:a,width:l,height:i,bottom:s,right:o}=r;return{top:n,left:a,width:l,height:i,bottom:s,right:o}}function ej(e){return ey(e,{ignoreTransform:!0})}function eN(e,t){let r=[];return e?function n(a){var l,i;let s;if(null!=t&&r.length>=t||!a)return r;if(A(a)&&null!=a.scrollingElement&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!B(a)||W(a)||r.includes(a))return r;let o=P(e).getComputedStyle(a);return(a!==e&&(void 0===(l=o)&&(l=P(a).getComputedStyle(a)),s=/(auto|scroll|overlay)/,["overflow","overflowX","overflowY"].some(e=>{let t=l[e];return"string"==typeof t&&s.test(t)}))&&r.push(a),void 0===(i=o)&&(i=P(a).getComputedStyle(a)),"fixed"===i.position)?r:n(a.parentNode)}(e):r}function ek(e){let[t]=eN(e,1);return null!=t?t:null}function eS(e){return T&&e?O(e)?e:F(e)?A(e)||e===Y(e).scrollingElement?window:B(e)?e:null:null:null}function ez(e){return O(e)?e.scrollX:e.scrollLeft}function eD(e){return O(e)?e.scrollY:e.scrollTop}function eC(e){return{x:ez(e),y:eD(e)}}function eM(e){return!!T&&!!e&&e===document.scrollingElement}function eE(e){let t={x:0,y:0},r=eM(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},a=e.scrollTop<=t.y,l=e.scrollLeft<=t.x;return{isTop:a,isLeft:l,isBottom:e.scrollTop>=n.y,isRight:e.scrollLeft>=n.x,maxScroll:n,minScroll:t}}(n=h||(h={}))[n.Forward=1]="Forward",n[n.Backward=-1]="Backward";let eL={x:.2,y:.2};function eR(e){return e.reduce((e,t)=>_(e,eC(t)),eu)}function eT(e,t){if(void 0===t&&(t=ey),!e)return;let{top:r,left:n,bottom:a,right:l}=t(e);ek(e)&&(a<=0||l<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}let eO=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+ez(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+eD(t),0)}]];class eF{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=eN(t),n=eR(r);for(const[t,a,l]of(this.rect={...e},this.width=e.width,this.height=e.height,eO))for(const e of a)Object.defineProperty(this,e,{get:()=>{let a=l(r),i=n[t]-a;return this.rect[e]+i},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class eP{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,r){var n;null==(n=this.target)||n.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function eA(e,t){let r=Math.abs(e.x),n=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t&&n>t.y}function eB(e){e.preventDefault()}function eW(e){e.stopPropagation()}(a=f||(f={})).Click="click",a.DragStart="dragstart",a.Keydown="keydown",a.ContextMenu="contextmenu",a.Resize="resize",a.SelectionChange="selectionchange",a.VisibilityChange="visibilitychange",(l=m||(m={})).Space="Space",l.Down="ArrowDown",l.Right="ArrowRight",l.Left="ArrowLeft",l.Up="ArrowUp",l.Esc="Escape",l.Enter="Enter",l.Tab="Tab";let eY={start:[m.Space,m.Enter],cancel:[m.Esc],end:[m.Space,m.Enter,m.Tab]},eI=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case m.Right:return{...r,x:r.x+25};case m.Left:return{...r,x:r.x-25};case m.Down:return{...r,y:r.y+25};case m.Up:return{...r,y:r.y-25}}};class eH{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new eP(Y(t)),this.windowListeners=new eP(P(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(f.Resize,this.handleCancel),this.windowListeners.add(f.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(f.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&eT(r),t(eu)}handleKeyDown(e){if(J(e)){let{active:t,context:r,options:n}=this.props,{keyboardCodes:a=eY,coordinateGetter:l=eI,scrollBehavior:i="smooth"}=n,{code:s}=e;if(a.end.includes(s))return void this.handleEnd(e);if(a.cancel.includes(s))return void this.handleCancel(e);let{collisionRect:o}=r.current,c=o?{x:o.left,y:o.top}:eu;this.referenceCoordinates||(this.referenceCoordinates=c);let d=l(e,{active:t,context:r.current,currentCoordinates:c});if(d){let t=Q(d,c),n={x:0,y:0},{scrollableAncestors:a}=r.current;for(let r of a){let a=e.code,{isTop:l,isRight:s,isLeft:o,isBottom:c,maxScroll:u,minScroll:h}=eE(r),f=function(e){if(e===document.scrollingElement){let{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}let{top:t,left:r,right:n,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:a,width:e.clientWidth,height:e.clientHeight}}(r),g={x:Math.min(a===m.Right?f.right-f.width/2:f.right,Math.max(a===m.Right?f.left:f.left+f.width/2,d.x)),y:Math.min(a===m.Down?f.bottom-f.height/2:f.bottom,Math.max(a===m.Down?f.top:f.top+f.height/2,d.y))},p=a===m.Right&&!s||a===m.Left&&!o,x=a===m.Down&&!c||a===m.Up&&!l;if(p&&g.x!==d.x){let e=r.scrollLeft+t.x,l=a===m.Right&&e<=u.x||a===m.Left&&e>=h.x;if(l&&!t.y)return void r.scrollTo({left:e,behavior:i});l?n.x=r.scrollLeft-e:n.x=a===m.Right?r.scrollLeft-u.x:r.scrollLeft-h.x,n.x&&r.scrollBy({left:-n.x,behavior:i});break}if(x&&g.y!==d.y){let e=r.scrollTop+t.y,l=a===m.Down&&e<=u.y||a===m.Up&&e>=h.y;if(l&&!t.x)return void r.scrollTo({top:e,behavior:i});l?n.y=r.scrollTop-e:n.y=a===m.Down?r.scrollTop-u.y:r.scrollTop-h.y,n.y&&r.scrollBy({top:-n.y,behavior:i});break}}this.handleMove(e,_(Q(d,this.referenceCoordinates),n))}}}handleMove(e,t){let{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){let{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){let{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function eU(e){return!!(e&&"distance"in e)}function eq(e){return!!(e&&"delay"in e)}eH.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=eY,onActivation:a}=t,{active:l}=r,{code:i}=e.nativeEvent;if(n.start.includes(i)){let t=l.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==a||a({event:e.nativeEvent}),!0)}return!1}}];class e${constructor(e,t,r){var n;void 0===r&&(r=function(e){let{EventTarget:t}=P(e);return e instanceof t?e:Y(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:a}=e,{target:l}=a;this.props=e,this.events=t,this.document=Y(l),this.documentListeners=new eP(this.document),this.listeners=new eP(r),this.windowListeners=new eP(P(l)),this.initialCoordinates=null!=(n=Z(a))?n:eu,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(f.Resize,this.handleCancel),this.windowListeners.add(f.DragStart,eB),this.windowListeners.add(f.VisibilityChange,this.handleCancel),this.windowListeners.add(f.ContextMenu,eB),this.documentListeners.add(f.Keydown,this.handleKeydown),t){if(null!=r&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(eq(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(eU(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){let{active:r,onPending:n}=this.props;n(r,e,this.initialCoordinates,t)}handleStart(){let{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(f.Click,eW,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(f.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;let{activated:r,initialCoordinates:n,props:a}=this,{onMove:l,options:{activationConstraint:i}}=a;if(!n)return;let s=null!=(t=Z(e))?t:eu,o=Q(n,s);if(!r&&i){if(eU(i)){if(null!=i.tolerance&&eA(o,i.tolerance))return this.handleCancel();if(eA(o,i.distance))return this.handleStart()}return eq(i)&&eA(o,i.tolerance)?this.handleCancel():void this.handlePending(i,o)}e.cancelable&&e.preventDefault(),l(s)}handleEnd(){let{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){let{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===m.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}let eX={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class eK extends e${constructor(e){const{event:t}=e;super(e,eX,Y(t.target))}}eK.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!!r.isPrimary&&0===r.button&&(null==n||n({event:r}),!0)}}];(i=g||(g={}))[i.RightClick=2]="RightClick";(s=p||(p={}))[s.Pointer=0]="Pointer",s[s.DraggableRect=1]="DraggableRect",(o=x||(x={}))[o.TreeOrder=0]="TreeOrder",o[o.ReversedTreeOrder=1]="ReversedTreeOrder";let eG={x:{[h.Backward]:!1,[h.Forward]:!1},y:{[h.Backward]:!1,[h.Forward]:!1}};(c=b||(b={}))[c.Always=0]="Always",c[c.BeforeDragging=1]="BeforeDragging",c[c.WhileDragging=2]="WhileDragging",(v||(v={})).Optimized="optimized";let eV=new Map;function e_(e,t){return q(r=>e?r||("function"==typeof t?t(e):e):null,[t,e])}function eQ(e){let{callback:t,disabled:r}=e,n=H(t),a=(0,L.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.ResizeObserver)return;let{ResizeObserver:e}=window;return new e(n)},[r]);return(0,L.useEffect)(()=>()=>null==a?void 0:a.disconnect(),[a]),a}function eJ(e){return new eF(ey(e),e)}function eZ(e,t,r){void 0===t&&(t=eJ);let[n,a]=(0,L.useState)(null);function l(){a(n=>{if(!e)return null;if(!1===e.isConnected){var a;return null!=(a=null!=n?n:r)?a:null}let l=t(e);return JSON.stringify(n)===JSON.stringify(l)?n:l})}let i=function(e){let{callback:t,disabled:r}=e,n=H(t),a=(0,L.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.MutationObserver)return;let{MutationObserver:e}=window;return new e(n)},[n,r]);return(0,L.useEffect)(()=>()=>null==a?void 0:a.disconnect(),[a]),a}({callback(t){if(e)for(let r of t){let{type:t,target:n}=r;if("childList"===t&&n instanceof HTMLElement&&n.contains(e)){l();break}}}}),s=eQ({callback:l});return I(()=>{l(),e?(null==s||s.observe(e),null==i||i.observe(document.body,{childList:!0,subtree:!0})):(null==s||s.disconnect(),null==i||i.disconnect())},[e]),n}let e0=[];function e1(e,t){void 0===t&&(t=[]);let r=(0,L.useRef)(null);return(0,L.useEffect)(()=>{r.current=null},t),(0,L.useEffect)(()=>{let t=e!==eu;t&&!r.current&&(r.current=e),!t&&r.current&&(r.current=null)},[e]),r.current?Q(e,r.current):eu}function e2(e){return(0,L.useMemo)(()=>{let t,r;return e?(t=e.innerWidth,{top:0,left:0,right:t,bottom:r=e.innerHeight,width:t,height:r}):null},[e])}let e4=[];function e5(e){if(!e)return null;if(e.children.length>1)return e;let t=e.children[0];return B(t)?t:e}let e9=[{sensor:eK,options:{}},{sensor:eH,options:{}}],e8={current:{}},e3={draggable:{measure:ej},droppable:{measure:ej,strategy:b.WhileDragging,frequency:v.Optimized},dragOverlay:{measure:ey}};class e6 extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}let e7={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new e6,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:ec},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:e3,measureDroppableContainers:ec,windowRect:null,measuringScheduled:!1},te={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:ec,draggableNodes:new Map,over:null,measureDroppableContainers:ec},tt=(0,L.createContext)(te),tr=(0,L.createContext)(e7);function tn(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new e6}}}function ta(e,t){switch(t.type){case u.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case u.DragMove:if(null==e.draggable.active)return e;return{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case u.DragEnd:case u.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case u.RegisterDroppable:{let{element:r}=t,{id:n}=r,a=new e6(e.droppable.containers);return a.set(n,r),{...e,droppable:{...e.droppable,containers:a}}}case u.SetDroppableDisabled:{let{id:r,key:n,disabled:a}=t,l=e.droppable.containers.get(r);if(!l||n!==l.key)return e;let i=new e6(e.droppable.containers);return i.set(r,{...l,disabled:a}),{...e,droppable:{...e.droppable,containers:i}}}case u.UnregisterDroppable:{let{id:r,key:n}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;let l=new e6(e.droppable.containers);return l.delete(r),{...e,droppable:{...e.droppable,containers:l}}}default:return e}}function tl(e){let{disabled:t}=e,{active:r,activatorEvent:n,draggableNodes:a}=(0,L.useContext)(tt),l=X(n),i=X(null==r?void 0:r.id);return(0,L.useEffect)(()=>{if(!t&&!n&&l&&null!=i){if(!J(l)||document.activeElement===l.target)return;let e=a.get(i);if(!e)return;let{activatorNode:t,node:r}=e;(t.current||r.current)&&requestAnimationFrame(()=>{for(let e of[t.current,r.current]){if(!e)continue;let t=e.matches(et)?e:e.querySelector(et);if(t){t.focus();break}}})}},[n,t,a,i,l]),null}function ti(e,t){let{transform:r,...n}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...n}),r):r}let ts=(0,L.createContext)({...eu,scaleX:1,scaleY:1});(d=w||(w={}))[d.Uninitialized=0]="Uninitialized",d[d.Initializing=1]="Initializing",d[d.Initialized=2]="Initialized";let to=(0,L.memo)(function(e){var t,r,n,a,l,i,s,o;let c,d,f,m,g,v,y,j,{id:N,accessibility:k,autoScroll:S=!0,children:z,sensors:D=e9,collisionDetection:C=ep,measuring:M,modifiers:E,...O}=e,[F,A]=(0,L.useReducer)(ta,void 0,tn),[W,Y]=function(){let[e]=(0,L.useState)(()=>new Set),t=(0,L.useCallback)(t=>(e.add(t),()=>e.delete(t)),[e]);return[(0,L.useCallback)(t=>{let{type:r,event:n}=t;e.forEach(e=>{var t;return null==(t=e[r])?void 0:t.call(e,n)})},[e]),t]}(),[H,K]=(0,L.useState)(w.Uninitialized),V=H===w.Initialized,{draggable:{active:Q,nodes:J,translate:ee},droppable:{containers:et}}=F,er=null!=Q?J.get(Q):null,en=(0,L.useRef)({initial:null,translated:null}),ea=(0,L.useMemo)(()=>{var e;return null!=Q?{id:Q,data:null!=(e=null==er?void 0:er.data)?e:e8,rect:en}:null},[Q,er]),ei=(0,L.useRef)(null),[es,ec]=(0,L.useState)(null),[ed,eh]=(0,L.useState)(null),ef=U(O,Object.values(O)),em=G("DndDescribedBy",N),eg=(0,L.useMemo)(()=>et.getEnabled(),[et]),ev=(0,L.useMemo)(()=>({draggable:{...e3.draggable,...null==M?void 0:M.draggable},droppable:{...e3.droppable,...null==M?void 0:M.droppable},dragOverlay:{...e3.dragOverlay,...null==M?void 0:M.dragOverlay}}),[null==M?void 0:M.draggable,null==M?void 0:M.droppable,null==M?void 0:M.dragOverlay]),{droppableRects:ew,measureDroppableContainers:ej,measuringScheduled:ez}=function(e,t){let{dragging:r,dependencies:n,config:a}=t,[l,i]=(0,L.useState)(null),{frequency:s,measure:o,strategy:c}=a,d=(0,L.useRef)(e),u=function(){switch(c){case b.Always:return!1;case b.BeforeDragging:return r;default:return!r}}(),h=U(u),f=(0,L.useCallback)(function(e){void 0===e&&(e=[]),h.current||i(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[h]),m=(0,L.useRef)(null),g=q(t=>{if(u&&!r)return eV;if(!t||t===eV||d.current!==e||null!=l){let t=new Map;for(let r of e){if(!r)continue;if(l&&l.length>0&&!l.includes(r.id)&&r.rect.current){t.set(r.id,r.rect.current);continue}let e=r.node.current,n=e?new eF(o(e),e):null;r.rect.current=n,n&&t.set(r.id,n)}return t}return t},[e,l,r,u,o]);return(0,L.useEffect)(()=>{d.current=e},[e]),(0,L.useEffect)(()=>{u||f()},[r,u]),(0,L.useEffect)(()=>{l&&l.length>0&&i(null)},[JSON.stringify(l)]),(0,L.useEffect)(()=>{u||"number"!=typeof s||null!==m.current||(m.current=setTimeout(()=>{f(),m.current=null},s))},[s,u,f,...n]),{droppableRects:g,measureDroppableContainers:f,measuringScheduled:null!=l}}(eg,{dragging:V,dependencies:[ee.x,ee.y],config:ev.droppable}),eD=q(e=>{var t;return null==Q?null:null!=(t=null!=g?g:e)?t:null},[g=(m=null!=Q?J.get(Q):void 0)?m.node.current:null,Q]),eT=(0,L.useMemo)(()=>ed?Z(ed):null,[ed]),eO=(c=(null==es?void 0:es.autoScrollEnabled)===!1,d="object"==typeof S?!1===S.enabled:!1===S,f=V&&!c&&!d,"object"==typeof S?{...S,enabled:f}:{enabled:f}),eP=e_(eD,ev.draggable.measure);!function(e){let{activeNode:t,measure:r,initialRect:n,config:a=!0}=e,l=(0,L.useRef)(!1),{x:i,y:s}="boolean"==typeof a?{x:a,y:a}:a;I(()=>{if(!i&&!s||!t){l.current=!1;return}if(l.current||!n)return;let e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;let a=ex(r(e),n);if(i||(a.x=0),s||(a.y=0),l.current=!0,Math.abs(a.x)>0||Math.abs(a.y)>0){let t=ek(e);t&&t.scrollBy({top:a.y,left:a.x})}},[t,i,s,n,r])}({activeNode:null!=Q?J.get(Q):null,config:eO.layoutShiftCompensation,initialRect:eP,measure:ev.draggable.measure});let eA=eZ(eD,ev.draggable.measure,eP),eB=eZ(eD?eD.parentElement:null),eW=(0,L.useRef)({activatorEvent:null,active:null,activeNode:eD,collisionRect:null,collisions:null,droppableRects:ew,draggableNodes:J,draggingNode:null,draggingNodeRect:null,droppableContainers:et,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),eY=et.getNodeFor(null==(t=eW.current.over)?void 0:t.id),eI=function(e){let{measure:t}=e,[r,n]=(0,L.useState)(null),a=eQ({callback:(0,L.useCallback)(e=>{for(let{target:r}of e)if(B(r)){n(e=>{let n=t(r);return e?{...e,width:n.width,height:n.height}:n});break}},[t])}),[l,i]=$((0,L.useCallback)(e=>{let r=e5(e);null==a||a.disconnect(),r&&(null==a||a.observe(r)),n(r?t(r):null)},[t,a]));return(0,L.useMemo)(()=>({nodeRef:l,rect:r,setRef:i}),[r,l,i])}({measure:ev.dragOverlay.measure}),eH=null!=(r=eI.nodeRef.current)?r:eD,eU=V?null!=(n=eI.rect)?n:eA:null,eq=!!(eI.nodeRef.current&&eI.rect),e$=(v=e_(l=eq?null:eA),ex(l,v)),eX=e2(eH?P(eH):null),eK=(i=V?null!=eY?eY:eD:null,y=(0,L.useRef)(i),j=q(e=>i?e&&e!==e0&&i&&y.current&&i.parentNode===y.current.parentNode?e:eN(i):e0,[i]),(0,L.useEffect)(()=>{y.current=i},[i]),j),eJ=function(e,t){void 0===t&&(t=ey);let[r]=e,n=e2(r?P(r):null),[a,l]=(0,L.useState)(e4);function i(){l(()=>e.length?e.map(e=>eM(e)?n:new eF(t(e),e)):e4)}let s=eQ({callback:i});return I(()=>{null==s||s.disconnect(),i(),e.forEach(e=>null==s?void 0:s.observe(e))},[e]),a}(eK),e6=ti(E,{transform:{x:ee.x-e$.x,y:ee.y-e$.y,scaleX:1,scaleY:1},activatorEvent:ed,active:ea,activeNodeRect:eA,containerNodeRect:eB,draggingNodeRect:eU,over:eW.current.over,overlayNodeRect:eI.rect,scrollableAncestors:eK,scrollableAncestorRects:eJ,windowRect:eX}),e7=eT?_(eT,ee):null,te=function(e){let[t,r]=(0,L.useState)(null),n=(0,L.useRef)(e),a=(0,L.useCallback)(e=>{let t=eS(e.target);t&&r(e=>e?(e.set(t,eC(t)),new Map(e)):null)},[]);return(0,L.useEffect)(()=>{let t=n.current;if(e!==t){l(t);let i=e.map(e=>{let t=eS(e);return t?(t.addEventListener("scroll",a,{passive:!0}),[t,eC(t)]):null}).filter(e=>null!=e);r(i.length?new Map(i):null),n.current=e}return()=>{l(e),l(t)};function l(e){e.forEach(e=>{let t=eS(e);null==t||t.removeEventListener("scroll",a)})}},[a,e]),(0,L.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>_(e,t),eu):eR(e):eu,[e,t])}(eK),to=e1(te),tc=e1(te,[eA]),td=_(e6,to),tu=eU?eb(eU,e6):null,th=ea&&tu?C({active:ea,collisionRect:tu,droppableRects:ew,droppableContainers:eg,pointerCoordinates:e7}):null,tf=function(e,t){if(!e||0===e.length)return null;let[r]=e;return r.id}(th,0),[tm,tg]=(0,L.useState)(null),tp=(s=eq?e6:_(e6,tc),o=null!=(a=null==tm?void 0:tm.rect)?a:null,{...s,scaleX:o&&eA?o.width/eA.width:1,scaleY:o&&eA?o.height/eA.height:1}),tx=(0,L.useRef)(null),tb=(0,L.useCallback)((e,t)=>{let{sensor:r,options:n}=t;if(null==ei.current)return;let a=J.get(ei.current);if(!a)return;let l=e.nativeEvent,i=new r({active:ei.current,activeNode:a,event:l,options:n,context:eW,onAbort(e){if(!J.get(e))return;let{onDragAbort:t}=ef.current,r={id:e};null==t||t(r),W({type:"onDragAbort",event:r})},onPending(e,t,r,n){if(!J.get(e))return;let{onDragPending:a}=ef.current,l={id:e,constraint:t,initialCoordinates:r,offset:n};null==a||a(l),W({type:"onDragPending",event:l})},onStart(e){let t=ei.current;if(null==t)return;let r=J.get(t);if(!r)return;let{onDragStart:n}=ef.current,a={activatorEvent:l,active:{id:t,data:r.data,rect:en}};(0,R.unstable_batchedUpdates)(()=>{null==n||n(a),K(w.Initializing),A({type:u.DragStart,initialCoordinates:e,active:t}),W({type:"onDragStart",event:a}),ec(tx.current),eh(l)})},onMove(e){A({type:u.DragMove,coordinates:e})},onEnd:s(u.DragEnd),onCancel:s(u.DragCancel)});function s(e){return async function(){let{active:t,collisions:r,over:n,scrollAdjustedTranslate:a}=eW.current,i=null;if(t&&a){let{cancelDrop:s}=ef.current;i={activatorEvent:l,active:t,collisions:r,delta:a,over:n},e===u.DragEnd&&"function"==typeof s&&await Promise.resolve(s(i))&&(e=u.DragCancel)}ei.current=null,(0,R.unstable_batchedUpdates)(()=>{A({type:e}),K(w.Uninitialized),tg(null),ec(null),eh(null),tx.current=null;let t=e===u.DragEnd?"onDragEnd":"onDragCancel";if(i){let e=ef.current[t];null==e||e(i),W({type:t,event:i})}})}}tx.current=i},[J]),tv=(0,L.useCallback)((e,t)=>(r,n)=>{let a=r.nativeEvent,l=J.get(n);null!==ei.current||!l||a.dndKit||a.defaultPrevented||!0===e(r,t.options,{active:l})&&(a.dndKit={capturedBy:t.sensor},ei.current=n,tb(r,t))},[J,tb]),tw=(0,L.useMemo)(()=>D.reduce((e,t)=>{let{sensor:r}=t;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:tv(e.handler,t)}))]},[]),[D,tv]);(0,L.useEffect)(()=>{if(!T)return;let e=D.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(let t of e)null==t||t()}},D.map(e=>{let{sensor:t}=e;return t})),I(()=>{eA&&H===w.Initializing&&K(w.Initialized)},[eA,H]),(0,L.useEffect)(()=>{let{onDragMove:e}=ef.current,{active:t,activatorEvent:r,collisions:n,over:a}=eW.current;if(!t||!r)return;let l={active:t,activatorEvent:r,collisions:n,delta:{x:td.x,y:td.y},over:a};(0,R.unstable_batchedUpdates)(()=>{null==e||e(l),W({type:"onDragMove",event:l})})},[td.x,td.y]),(0,L.useEffect)(()=>{let{active:e,activatorEvent:t,collisions:r,droppableContainers:n,scrollAdjustedTranslate:a}=eW.current;if(!e||null==ei.current||!t||!a)return;let{onDragOver:l}=ef.current,i=n.get(tf),s=i&&i.rect.current?{id:i.id,rect:i.rect.current,data:i.data,disabled:i.disabled}:null,o={active:e,activatorEvent:t,collisions:r,delta:{x:a.x,y:a.y},over:s};(0,R.unstable_batchedUpdates)(()=>{tg(s),null==l||l(o),W({type:"onDragOver",event:o})})},[tf]),I(()=>{eW.current={activatorEvent:ed,active:ea,activeNode:eD,collisionRect:tu,collisions:th,droppableRects:ew,draggableNodes:J,draggingNode:eH,draggingNodeRect:eU,droppableContainers:et,over:tm,scrollableAncestors:eK,scrollAdjustedTranslate:td},en.current={initial:eU,translated:tu}},[ea,eD,th,tu,J,eH,eU,ew,et,tm,eK,td]),function(e){let t,{acceleration:r,activator:n=p.Pointer,canScroll:a,draggingRect:l,enabled:i,interval:s=5,order:o=x.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:f,threshold:m}=e,g=function(e){let{delta:t,disabled:r}=e,n=X(t);return q(e=>{if(r||!n||!e)return eG;let a={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[h.Backward]:e.x[h.Backward]||-1===a.x,[h.Forward]:e.x[h.Forward]||1===a.x},y:{[h.Backward]:e.y[h.Backward]||-1===a.y,[h.Forward]:e.y[h.Forward]||1===a.y}}},[r,t,n])}({delta:f,disabled:!i}),[b,v]=(t=(0,L.useRef)(null),[(0,L.useCallback)((e,r)=>{t.current=setInterval(e,r)},[]),(0,L.useCallback)(()=>{null!==t.current&&(clearInterval(t.current),t.current=null)},[])]),w=(0,L.useRef)({x:0,y:0}),y=(0,L.useRef)({x:0,y:0}),j=(0,L.useMemo)(()=>{switch(n){case p.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case p.DraggableRect:return l}},[n,l,c]),N=(0,L.useRef)(null),k=(0,L.useCallback)(()=>{let e=N.current;if(!e)return;let t=w.current.x*y.current.x,r=w.current.y*y.current.y;e.scrollBy(t,r)},[]),S=(0,L.useMemo)(()=>o===x.TreeOrder?[...d].reverse():d,[o,d]);(0,L.useEffect)(()=>{if(!i||!d.length||!j)return void v();for(let e of S){if((null==a?void 0:a(e))===!1)continue;let t=u[d.indexOf(e)];if(!t)continue;let{direction:n,speed:l}=function(e,t,r,n,a){let{top:l,left:i,right:s,bottom:o}=r;void 0===n&&(n=10),void 0===a&&(a=eL);let{isTop:c,isBottom:d,isLeft:u,isRight:f}=eE(e),m={x:0,y:0},g={x:0,y:0},p={height:t.height*a.y,width:t.width*a.x};return!c&&l<=t.top+p.height?(m.y=h.Backward,g.y=n*Math.abs((t.top+p.height-l)/p.height)):!d&&o>=t.bottom-p.height&&(m.y=h.Forward,g.y=n*Math.abs((t.bottom-p.height-o)/p.height)),!f&&s>=t.right-p.width?(m.x=h.Forward,g.x=n*Math.abs((t.right-p.width-s)/p.width)):!u&&i<=t.left+p.width&&(m.x=h.Backward,g.x=n*Math.abs((t.left+p.width-i)/p.width)),{direction:m,speed:g}}(e,t,j,r,m);for(let e of["x","y"])g[e][n[e]]||(l[e]=0,n[e]=0);if(l.x>0||l.y>0){v(),N.current=e,b(k,s),w.current=l,y.current=n;return}}w.current={x:0,y:0},y.current={x:0,y:0},v()},[r,k,a,v,i,s,JSON.stringify(j),JSON.stringify(g),b,d,S,u,JSON.stringify(m)])}({...eO,delta:ee,draggingRect:tu,pointerCoordinates:e7,scrollableAncestors:eK,scrollableAncestorRects:eJ});let ty=(0,L.useMemo)(()=>({active:ea,activeNode:eD,activeNodeRect:eA,activatorEvent:ed,collisions:th,containerNodeRect:eB,dragOverlay:eI,draggableNodes:J,droppableContainers:et,droppableRects:ew,over:tm,measureDroppableContainers:ej,scrollableAncestors:eK,scrollableAncestorRects:eJ,measuringConfiguration:ev,measuringScheduled:ez,windowRect:eX}),[ea,eD,eA,ed,th,eB,eI,J,et,ew,tm,ej,eK,eJ,ev,ez,eX]),tj=(0,L.useMemo)(()=>({activatorEvent:ed,activators:tw,active:ea,activeNodeRect:eA,ariaDescribedById:{draggable:em},dispatch:A,draggableNodes:J,over:tm,measureDroppableContainers:ej}),[ed,tw,ea,eA,A,em,J,tm,ej]);return L.default.createElement(el.Provider,{value:Y},L.default.createElement(tt.Provider,{value:tj},L.default.createElement(tr.Provider,{value:ty},L.default.createElement(ts.Provider,{value:tp},z)),L.default.createElement(tl,{disabled:(null==k?void 0:k.restoreFocus)===!1})),L.default.createElement(eo,{...k,hiddenTextDescribedById:em}))});function tc(){return(0,L.useContext)(tr)}let td={timeout:25};function tu(e){let{animation:t,children:r}=e,[n,a]=(0,L.useState)(null),[l,i]=(0,L.useState)(null),s=X(r);return r||n||!s||a(s),I(()=>{if(!l)return;let e=null==n?void 0:n.key,r=null==n?void 0:n.props.id;null==e||null==r?a(null):Promise.resolve(t(r,l)).then(()=>{a(null)})},[t,n,l]),L.default.createElement(L.default.Fragment,null,r,n?(0,L.cloneElement)(n,{ref:i}):null)}let th={x:0,y:0,scaleX:1,scaleY:1};function tf(e){let{children:t}=e;return L.default.createElement(tt.Provider,{value:te},L.default.createElement(ts.Provider,{value:th},t))}let tm={position:"fixed",touchAction:"none"},tg=e=>J(e)?"transform 250ms ease":void 0,tp=(0,L.forwardRef)((e,t)=>{let{as:r,activatorEvent:n,adjustScale:a,children:l,className:i,rect:s,style:o,transform:c,transition:d=tg}=e;if(!s)return null;let u=a?c:{...c,scaleX:1,scaleY:1},h={...tm,width:s.width,height:s.height,top:s.top,left:s.left,transform:ee.Transform.toString(u),transformOrigin:a&&n?function(e,t){let r=Z(e);if(!r)return"0 0";let n={x:(r.x-t.left)/t.width*100,y:(r.y-t.top)/t.height*100};return n.x+"% "+n.y+"%"}(n,s):void 0,transition:"function"==typeof d?d(n):d,...o};return L.default.createElement(r,{className:i,style:h,ref:t},l)}),tx={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:r}}=e;return[{transform:ee.Transform.toString(t)},{transform:ee.Transform.toString(r)}]},sideEffects:(t={styles:{active:{opacity:"0"}}},e=>{let{active:r,dragOverlay:n}=e,a={},{styles:l,className:i}=t;if(null!=l&&l.active)for(let[e,t]of Object.entries(l.active))void 0!==t&&(a[e]=r.node.style.getPropertyValue(e),r.node.style.setProperty(e,t));if(null!=l&&l.dragOverlay)for(let[e,t]of Object.entries(l.dragOverlay))void 0!==t&&n.node.style.setProperty(e,t);return null!=i&&i.active&&r.node.classList.add(i.active),null!=i&&i.dragOverlay&&n.node.classList.add(i.dragOverlay),function(){for(let[e,t]of Object.entries(a))r.node.style.setProperty(e,t);null!=i&&i.active&&r.node.classList.remove(i.active)}})},tb=0,tv=L.default.memo(e=>{var t;let{adjustScale:r=!1,children:n,dropAnimation:a,style:l,transition:i,modifiers:s,wrapperElement:o="div",className:c,zIndex:d=999}=e,{activatorEvent:u,active:h,activeNodeRect:f,containerNodeRect:m,draggableNodes:g,droppableContainers:p,dragOverlay:x,over:b,measuringConfiguration:v,scrollableAncestors:w,scrollableAncestorRects:y,windowRect:j}=tc(),N=(0,L.useContext)(ts),k=(t=null==h?void 0:h.id,(0,L.useMemo)(()=>{if(null!=t)return++tb},[t])),S=ti(s,{activatorEvent:u,active:h,activeNodeRect:f,containerNodeRect:m,draggingNodeRect:x.rect,over:b,overlayNodeRect:x.rect,scrollableAncestors:w,scrollableAncestorRects:y,transform:N,windowRect:j}),z=e_(f),D=function(e){let{config:t,draggableNodes:r,droppableContainers:n,measuringConfiguration:a}=e;return H((e,l)=>{if(null===t)return;let i=r.get(e);if(!i)return;let s=i.node.current;if(!s)return;let o=e5(l);if(!o)return;let{transform:c}=P(l).getComputedStyle(l),d=ev(c);if(!d)return;let u="function"==typeof t?t:function(e){let{duration:t,easing:r,sideEffects:n,keyframes:a}={...tx,...e};return e=>{let{active:l,dragOverlay:i,transform:s,...o}=e;if(!t)return;let c={x:i.rect.left-l.rect.left,y:i.rect.top-l.rect.top},d={scaleX:1!==s.scaleX?l.rect.width*s.scaleX/i.rect.width:1,scaleY:1!==s.scaleY?l.rect.height*s.scaleY/i.rect.height:1},u={x:s.x-c.x,y:s.y-c.y,...d},h=a({...o,active:l,dragOverlay:i,transform:{initial:s,final:u}}),[f]=h,m=h[h.length-1];if(JSON.stringify(f)===JSON.stringify(m))return;let g=null==n?void 0:n({active:l,dragOverlay:i,...o}),p=i.node.animate(h,{duration:t,easing:r,fill:"forwards"});return new Promise(e=>{p.onfinish=()=>{null==g||g(),e()}})}}(t);return eT(s,a.draggable.measure),u({active:{id:e,data:i.data,node:s,rect:a.draggable.measure(s)},draggableNodes:r,dragOverlay:{node:l,rect:a.dragOverlay.measure(o)},droppableContainers:n,measuringConfiguration:a,transform:d})})}({config:a,draggableNodes:g,droppableContainers:p,measuringConfiguration:v}),C=z?x.setRef:void 0;return L.default.createElement(tf,null,L.default.createElement(tu,{animation:D},h&&k?L.default.createElement(tp,{key:k,id:h.id,ref:C,as:o,activatorEvent:u,adjustScale:r,className:c,transition:i,rect:z,style:{zIndex:d,...l},transform:S},n):null))}),tw=e=>{let t,{rects:r,activeIndex:n,overIndex:a,index:l}=e,i=((t=r.slice()).splice(n<0?t.length+n:n,0,t.splice(a,1)[0]),t),s=r[l],o=i[l];return o&&s?{x:o.left-s.left,y:o.top-s.top,scaleX:o.width/s.width,scaleY:o.height/s.height}:null},ty="Sortable",tj=L.default.createContext({activeIndex:-1,containerId:ty,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:tw,disabled:{draggable:!1,droppable:!1}});function tN(e){let{children:t,id:r,items:n,strategy:a=tw,disabled:l=!1}=e,{active:i,dragOverlay:s,droppableRects:o,over:c,measureDroppableContainers:d}=tc(),u=G(ty,r),h=null!==s.rect,f=(0,L.useMemo)(()=>n.map(e=>"object"==typeof e&&"id"in e?e.id:e),[n]),m=null!=i,g=i?f.indexOf(i.id):-1,p=c?f.indexOf(c.id):-1,x=(0,L.useRef)(f),b=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(f,x.current),v=-1!==p&&-1===g||b,w="boolean"==typeof l?{draggable:l,droppable:l}:l;I(()=>{b&&m&&d(f)},[b,f,m,d]),(0,L.useEffect)(()=>{x.current=f},[f]);let y=(0,L.useMemo)(()=>({activeIndex:g,containerId:u,disabled:w,disableTransforms:v,items:f,overIndex:p,useDragOverlay:h,sortedRects:f.reduce((e,t,r)=>{let n=o.get(t);return n&&(e[r]=n),e},Array(f.length)),strategy:a}),[g,u,w.draggable,w.droppable,v,f,p,o,h,a]);return L.default.createElement(tj.Provider,{value:y},t)}m.Down,m.Right,m.Up,m.Left;var tk=e.i(37300);function tS({id:e,title:t,count:r,children:n}){let{setNodeRef:a,isOver:l}=function(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:a}=e,l=G("Droppable"),{active:i,dispatch:s,over:o,measureDroppableContainers:c}=(0,L.useContext)(tt),d=(0,L.useRef)({disabled:r}),h=(0,L.useRef)(!1),f=(0,L.useRef)(null),m=(0,L.useRef)(null),{disabled:g,updateMeasurementsFor:p,timeout:x}={...td,...a},b=U(null!=p?p:n),v=eQ({callback:(0,L.useCallback)(()=>{if(!h.current){h.current=!0;return}null!=m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(b.current)?b.current:[b.current]),m.current=null},x)},[x]),disabled:g||!i}),[w,y]=$((0,L.useCallback)((e,t)=>{v&&(t&&(v.unobserve(t),h.current=!1),e&&v.observe(e))},[v])),j=U(t);return(0,L.useEffect)(()=>{v&&w.current&&(v.disconnect(),h.current=!1,v.observe(w.current))},[w,v]),(0,L.useEffect)(()=>(s({type:u.RegisterDroppable,element:{id:n,key:l,disabled:r,node:w,rect:f,data:j}}),()=>s({type:u.UnregisterDroppable,key:l,id:n})),[n]),(0,L.useEffect)(()=>{r!==d.current.disabled&&(s({type:u.SetDroppableDisabled,id:n,key:l,disabled:r}),d.current.disabled=r)},[n,l,r,s]),{active:i,rect:f,isOver:(null==o?void 0:o.id)===n,node:w,over:o,setNodeRef:y}}({id:e});return(0,y.jsxs)("div",{ref:a,className:`flex min-w-[300px] flex-col rounded-lg border bg-zinc-900 transition-colors ${l?"border-amber-500 bg-zinc-800/50":"border-zinc-800"}`,children:[(0,y.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-800 p-4",children:[(0,y.jsx)("h2",{className:"font-semibold text-zinc-100",children:t}),(0,y.jsx)("span",{className:"rounded-full bg-zinc-800 px-2 py-1 text-xs text-zinc-400",children:r})]}),(0,y.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:n})]})}var tz=e.i(41074),tD=e.i(69279),tC=e.i(65458);function tM({lead:e,onClick:t,isDragging:r}){let n=!!e.ad.phoneNumber,a=e.ad.isWhatsappPhone;return(0,y.jsx)(tD.Card,{onClick:t,className:`group cursor-pointer transition-all hover:border-amber-500/50 ${r?"border-amber-500 opacity-50":"hover:shadow-lg hover:shadow-amber-500/10"}`,children:(0,y.jsxs)(tD.CardContent,{className:"p-3",children:[(0,y.jsx)("div",{className:"relative mb-3 aspect-video overflow-hidden rounded-md bg-zinc-800",children:e.ad.picture?(0,y.jsx)(tz.default,{src:e.ad.picture,alt:e.ad.title,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}):(0,y.jsx)("div",{className:"flex h-full items-center justify-center text-zinc-600",children:(0,y.jsx)("svg",{className:"h-8 w-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,y.jsx)("h3",{className:"mb-2 line-clamp-2 text-sm font-medium text-zinc-100",children:e.ad.title}),(0,y.jsxs)("div",{className:"mb-2 flex items-center justify-between text-xs text-zinc-400",children:[(0,y.jsx)("span",{className:"font-semibold text-amber-500",children:e.ad.price?`${e.ad.price.toLocaleString("fr-FR")} €`:"Prix non spécifié"}),(0,y.jsx)("span",{children:e.ad.zipcode.name})]}),(0,y.jsxs)("div",{className:"flex gap-2",children:[n&&(0,y.jsxs)(tC.Badge,{variant:"secondary",className:"gap-1",children:[(0,y.jsx)("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),(0,y.jsx)("span",{children:"Tél"})]}),a&&(0,y.jsxs)(tC.Badge,{variant:"outline",className:"gap-1 bg-green-900/30 text-green-400 border-green-500/20",children:[(0,y.jsx)("svg",{className:"h-3 w-3",fill:"currentColor",viewBox:"0 0 24 24",children:(0,y.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})}),(0,y.jsx)("span",{children:"WhatsApp"})]}),(0,y.jsx)(tC.Badge,{variant:"outline",className:"ml-auto bg-blue-900/30 text-blue-400 border-blue-500/20",children:"LBC"})]})]})})}let tE=(0,j.createServerReference)("60a072972f4910e494169b648c8535160e0004e907",j.callServer,void 0,j.findSourceMapURL,"addLeadNote"),tL=(0,j.createServerReference)("7081dde443da713cd9b26d85ee004ea263c5708e04",j.callServer,void 0,j.findSourceMapURL,"addLeadReminder"),tR=(0,j.createServerReference)("60b34ebf9bf068fea6a73474b91f2d5419eadf343e",j.callServer,void 0,j.findSourceMapURL,"assignLead"),tT=(0,j.createServerReference)("4059db70c15d9497d084adb458bf761869623a7a94",j.callServer,void 0,j.findSourceMapURL,"deleteLeadReminder"),tO=(0,j.createServerReference)("40abed2c5b10b09605427ad68c1e5d1af19bbd1f78",j.callServer,void 0,j.findSourceMapURL,"fetchLeadDetails"),tF=(0,j.createServerReference)("40da113c71834aa7676191e8f90039431d5c90d234",j.callServer,void 0,j.findSourceMapURL,"fetchLeadTeamMembers"),tP=(0,j.createServerReference)("401540e838a62e09eb1eeaba6e998d062d354b5304",j.callServer,void 0,j.findSourceMapURL,"getDefaultWhatsAppTemplate"),tA=(0,j.createServerReference)("7013b2cfceb896ab0561b14d5adfd1fb89f374894b",j.callServer,void 0,j.findSourceMapURL,"logWhatsAppMessage");function tB({value:e,onChange:t,options:r,placeholder:n="Sélectionner...",label:a,disabled:l=!1,allowNull:i=!1,nullLabel:s="Aucun"}){let[o,c]=(0,L.useState)(!1),d=(0,L.useRef)(null),u=r.find(t=>t.value===e);(0,L.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&c(!1)};return o&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[o]);let h=e=>{t(e),c(!1)};return(0,y.jsxs)("div",{ref:d,className:"relative",children:[a&&(0,y.jsx)("label",{className:"mb-2 block text-sm font-medium text-zinc-400",children:a}),(0,y.jsxs)("button",{type:"button",onClick:()=>!l&&c(!o),disabled:l,className:`flex w-full items-center justify-between gap-2 rounded-lg border px-4 py-2.5 text-left transition-colors ${l?"cursor-not-allowed border-zinc-800 bg-zinc-900/50 text-zinc-600":"border-zinc-800 bg-zinc-900/50 text-zinc-200 hover:border-zinc-700 hover:bg-zinc-900"} ${o?"border-amber-500/50 ring-2 ring-amber-500/20":""}`,children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[u?.icon&&(0,y.jsx)("span",{className:"flex-shrink-0",children:u.icon}),u?.color&&(0,y.jsx)("span",{className:"h-2 w-2 flex-shrink-0 rounded-full",style:{backgroundColor:u.color}}),(0,y.jsx)("span",{className:u?"text-zinc-200":"text-zinc-500",children:u?.label||n})]}),(0,y.jsx)("svg",{className:`h-4 w-4 flex-shrink-0 transition-transform ${o?"rotate-180":""} ${l?"text-zinc-600":"text-zinc-400"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),o&&!l&&(0,y.jsx)("div",{className:"absolute z-50 mt-2 w-full overflow-hidden rounded-lg border border-zinc-800 bg-zinc-900 shadow-2xl",children:(0,y.jsxs)("div",{className:"max-h-64 overflow-y-auto",children:[i&&(0,y.jsx)("button",{type:"button",onClick:()=>h(null),className:"flex w-full items-center gap-2 px-4 py-2.5 text-left text-sm transition-colors hover:bg-zinc-800",children:(0,y.jsx)("span",{className:"text-zinc-400",children:s})}),r.map(t=>(0,y.jsxs)("button",{type:"button",onClick:()=>h(t.value),className:`flex w-full items-center gap-2 px-4 py-2.5 text-left text-sm transition-colors hover:bg-zinc-800 ${e===t.value?"bg-zinc-800/50":""}`,children:[t.icon&&(0,y.jsx)("span",{className:"flex-shrink-0",children:t.icon}),t.color&&(0,y.jsx)("span",{className:"h-2 w-2 flex-shrink-0 rounded-full",style:{backgroundColor:t.color}}),(0,y.jsx)("span",{className:"text-zinc-200",children:t.label}),e===t.value&&(0,y.jsx)("svg",{className:"ml-auto h-4 w-4 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},t.value))]})})]})}var tW=e.i(92767),tY=e.i(5122),tI=e.i(94209);e.i(1032);var tH=e.i(95094),tU=e.i(62545),tq=e.i(68220),t$=e.i(55378),tX=e.i(59016),tK=e.i(41121),tG=e.i(91491),tV=e.i(65796);function t_(e,t){let r=(0,tV.toDate)(e,t?.in);return r.setHours(0,0,0,0),r}function tQ(e,t){let r=(0,t$.getDefaultOptions)(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=(0,tV.toDate)(e,t?.in),l=a.getDay();return a.setDate(a.getDate()-(7*(l<n)+l-n)),a.setHours(0,0,0,0),a}function tJ(e,t){return tQ(e,{...t,weekStartsOn:1})}var tZ=e.i(74913);function t0(e,t){let r=(0,tV.toDate)(e,t?.in),n=r.getFullYear(),a=(0,tZ.constructFrom)(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);let l=tJ(a),i=(0,tZ.constructFrom)(r,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);let s=tJ(i);return r.getTime()>=l.getTime()?n+1:r.getTime()>=s.getTime()?n:n-1}function t1(e,t){let r=(0,tV.toDate)(e,t?.in),n=r.getFullYear(),a=(0,t$.getDefaultOptions)(),l=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,i=(0,tZ.constructFrom)(t?.in||e,0);i.setFullYear(n+1,0,l),i.setHours(0,0,0,0);let s=tQ(i,t),o=(0,tZ.constructFrom)(t?.in||e,0);o.setFullYear(n,0,l),o.setHours(0,0,0,0);let c=tQ(o,t);return+r>=+s?n+1:+r>=+c?n:n-1}function t2(e,t){let r=Math.abs(e).toString().padStart(t,"0");return(e<0?"-":"")+r}let t4={y(e,t){let r=e.getFullYear(),n=r>0?r:1-r;return t2("yy"===t?n%100:n,t.length)},M(e,t){let r=e.getMonth();return"M"===t?String(r+1):t2(r+1,2)},d:(e,t)=>t2(e.getDate(),t.length),a(e,t){let r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return"am"===r?"a.m.":"p.m."}},h:(e,t)=>t2(e.getHours()%12||12,t.length),H:(e,t)=>t2(e.getHours(),t.length),m:(e,t)=>t2(e.getMinutes(),t.length),s:(e,t)=>t2(e.getSeconds(),t.length),S(e,t){let r=t.length;return t2(Math.trunc(e.getMilliseconds()*Math.pow(10,r-3)),t.length)}},t5={G:function(e,t,r){let n=+(e.getFullYear()>0);switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if("yo"===t){let t=e.getFullYear();return r.ordinalNumber(t>0?t:1-t,{unit:"year"})}return t4.y(e,t)},Y:function(e,t,r,n){let a=t1(e,n),l=a>0?a:1-a;return"YY"===t?t2(l%100,2):"Yo"===t?r.ordinalNumber(l,{unit:"year"}):t2(l,t.length)},R:function(e,t){return t2(t0(e),t.length)},u:function(e,t){return t2(e.getFullYear(),t.length)},Q:function(e,t,r){let n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return t2(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){let n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return t2(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){let n=e.getMonth();switch(t){case"M":case"MM":return t4.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){let n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return t2(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){let a,l,i,s,o,c=Math.round((tQ(a=(0,tV.toDate)(e,n?.in),n)-(l=(0,t$.getDefaultOptions)(),i=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??l.firstWeekContainsDate??l.locale?.options?.firstWeekContainsDate??1,s=t1(a,n),(o=(0,tZ.constructFrom)(n?.in||a,0)).setFullYear(s,0,i),o.setHours(0,0,0,0),tQ(o,n)))/tG.millisecondsInWeek)+1;return"wo"===t?r.ordinalNumber(c,{unit:"week"}):t2(c,t.length)},I:function(e,t,r){let n,a,l,i=Math.round((tJ(n=(0,tV.toDate)(e,void 0))-(a=t0(n,void 0),(l=(0,tZ.constructFrom)(n,0)).setFullYear(a,0,4),l.setHours(0,0,0,0),tJ(l)))/tG.millisecondsInWeek)+1;return"Io"===t?r.ordinalNumber(i,{unit:"week"}):t2(i,t.length)},d:function(e,t,r){return"do"===t?r.ordinalNumber(e.getDate(),{unit:"date"}):t4.d(e,t)},D:function(e,t,r){let n,a,l=function(e,t,r){let[n,a]=(0,tK.normalizeDates)(void 0,e,t),l=t_(n),i=t_(a);return Math.round((l-(0,tX.getTimezoneOffsetInMilliseconds)(l)-(i-(0,tX.getTimezoneOffsetInMilliseconds)(i)))/tG.millisecondsInDay)}(n=(0,tV.toDate)(e,void 0),((a=(0,tV.toDate)(n,void 0)).setFullYear(a.getFullYear(),0,1),a.setHours(0,0,0,0),a))+1;return"Do"===t?r.ordinalNumber(l,{unit:"dayOfYear"}):t2(l,t.length)},E:function(e,t,r){let n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){let a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return t2(l,2);case"eo":return r.ordinalNumber(l,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){let a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return t2(l,t.length);case"co":return r.ordinalNumber(l,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){let n=e.getDay(),a=0===n?7:n;switch(t){case"i":return String(a);case"ii":return t2(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){let n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){let n,a=e.getHours();switch(n=12===a?"noon":0===a?"midnight":a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){let n,a=e.getHours();switch(n=a>=17?"evening":a>=12?"afternoon":a>=4?"morning":"night",t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),r.ordinalNumber(t,{unit:"hour"})}return t4.h(e,t)},H:function(e,t,r){return"Ho"===t?r.ordinalNumber(e.getHours(),{unit:"hour"}):t4.H(e,t)},K:function(e,t,r){let n=e.getHours()%12;return"Ko"===t?r.ordinalNumber(n,{unit:"hour"}):t2(n,t.length)},k:function(e,t,r){let n=e.getHours();return(0===n&&(n=24),"ko"===t)?r.ordinalNumber(n,{unit:"hour"}):t2(n,t.length)},m:function(e,t,r){return"mo"===t?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):t4.m(e,t)},s:function(e,t,r){return"so"===t?r.ordinalNumber(e.getSeconds(),{unit:"second"}):t4.s(e,t)},S:function(e,t){return t4.S(e,t)},X:function(e,t,r){let n=e.getTimezoneOffset();if(0===n)return"Z";switch(t){case"X":return t8(n);case"XXXX":case"XX":return t3(n);default:return t3(n,":")}},x:function(e,t,r){let n=e.getTimezoneOffset();switch(t){case"x":return t8(n);case"xxxx":case"xx":return t3(n);default:return t3(n,":")}},O:function(e,t,r){let n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+t9(n,":");default:return"GMT"+t3(n,":")}},z:function(e,t,r){let n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+t9(n,":");default:return"GMT"+t3(n,":")}},t:function(e,t,r){return t2(Math.trunc(e/1e3),t.length)},T:function(e,t,r){return t2(+e,t.length)}};function t9(e,t=""){let r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),l=n%60;return 0===l?r+String(a):r+String(a)+t+t2(l,2)}function t8(e,t){return e%60==0?(e>0?"-":"+")+t2(Math.abs(e)/60,2):t3(e,t)}function t3(e,t=""){let r=Math.abs(e);return(e>0?"-":"+")+t2(Math.trunc(r/60),2)+t+t2(r%60,2)}let t6=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},t7=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},re={p:t7,P:(e,t)=>{let r,n=e.match(/(P+)(p+)?/)||[],a=n[1],l=n[2];if(!l)return t6(e,t);switch(a){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;default:r=t.dateTime({width:"full"})}return r.replace("{{date}}",t6(a,t)).replace("{{time}}",t7(l,t))}},rt=/^D+$/,rr=/^Y+$/,rn=["D","DD","YY","YYYY"],ra=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,rl=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ri=/^'([^]*?)'?$/,rs=/''/g,ro=/[a-zA-Z]/;var rc=e.i(39318),rd=e.i(87958),ru=e.i(55361),rh=e.i(8303);function rf({className:e,...t}){return(0,y.jsx)("div",{"data-slot":"skeleton",className:(0,rh.cn)("bg-accent animate-pulse rounded-md",e),...t})}function rm(){return(0,y.jsxs)("div",{className:"space-y-6 p-6",children:[(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsx)(rf,{className:"aspect-video w-full rounded-xl"}),(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsx)(rf,{className:"h-16 w-24 flex-shrink-0 rounded-lg"}),(0,y.jsx)(rf,{className:"h-16 w-24 flex-shrink-0 rounded-lg"}),(0,y.jsx)(rf,{className:"h-16 w-24 flex-shrink-0 rounded-lg"})]})]}),(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsx)(rf,{className:"h-7 w-full"}),(0,y.jsx)(rf,{className:"h-7 w-3/4"}),(0,y.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,y.jsx)(rf,{className:"h-8 w-32"}),(0,y.jsx)(rf,{className:"h-4 w-40"}),(0,y.jsx)(rf,{className:"h-4 w-36"})]})]}),(0,y.jsxs)("section",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(rf,{className:"h-4 w-16"}),(0,y.jsx)(rf,{className:"h-10 w-full rounded-lg"})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(rf,{className:"h-4 w-20"}),(0,y.jsx)(rf,{className:"h-10 w-full rounded-lg"})]})]}),(0,y.jsxs)("section",{className:"grid grid-cols-2 gap-3",children:[(0,y.jsx)(rf,{className:"h-12 rounded-lg"}),(0,y.jsx)(rf,{className:"h-12 rounded-lg"}),(0,y.jsx)(rf,{className:"h-12 rounded-lg"}),(0,y.jsx)(rf,{className:"h-12 rounded-lg"})]}),(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsx)(rf,{className:"h-4 w-32"}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,y.jsx)(rf,{className:"h-16 rounded-lg"}),(0,y.jsx)(rf,{className:"h-16 rounded-lg"}),(0,y.jsx)(rf,{className:"h-16 rounded-lg"}),(0,y.jsx)(rf,{className:"h-16 rounded-lg"}),(0,y.jsx)(rf,{className:"h-16 rounded-lg"}),(0,y.jsx)(rf,{className:"h-16 rounded-lg"})]})]}),(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsx)(rf,{className:"h-4 w-24"}),(0,y.jsx)(rf,{className:"h-20 w-full rounded-lg"})]}),(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsx)(rf,{className:"h-4 w-16"}),(0,y.jsx)(rf,{className:"h-24 w-full rounded-lg"}),(0,y.jsx)(rf,{className:"h-9 w-32 rounded-lg"})]}),(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsx)(rf,{className:"h-4 w-20"}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(rf,{className:"h-10 w-full rounded-lg"}),(0,y.jsx)(rf,{className:"h-20 w-full rounded-lg"})]}),(0,y.jsx)(rf,{className:"h-9 w-24 rounded-lg"})]}),(0,y.jsx)(rf,{className:"h-12 w-full rounded-lg"})]})}function rg({leadId:e,onClose:t}){let{data:r,error:n,isLoading:a,mutate:l}=(0,tk.default)(e?S.swrKeys.leads.drawer(e):null,()=>tO(e),{dedupingInterval:5e3,revalidateOnFocus:!0}),{data:i=[]}=(0,tk.default)(e?S.swrKeys.settings.members:null,()=>tF(e),{dedupingInterval:1e4}),[s,o]=(0,L.useState)(0),[c,d]=(0,L.useState)(!1),u=(0,ru.useForm)({resolver:(0,tU.zodResolver)(tH.leadNoteSchema),defaultValues:{content:""}}),h=(0,ru.useForm)({resolver:(0,tU.zodResolver)(tH.leadReminderFormSchema),defaultValues:{dueAt:new Date}}),f=async e=>{if(r&&e){l({...r,stage:e},{revalidate:!1,optimisticData:{...r,stage:e}});try{await k(r.id,e),l()}catch(e){l(),console.error("Failed to update stage:",e)}}},m=async e=>{if(!r)return;let t=e?i.find(t=>t.id===e):null,n={...r,assignedTo:t?{id:t.id,name:t.name}:null};l(n,{revalidate:!1,optimisticData:n});try{await tR(r.id,e),l()}catch(e){l(),console.error("Failed to update assignment:",e)}},g=async()=>{if(r&&r.ad.phoneNumber&&!c){d(!0);try{let e=await tP(r.id),t=function(e){let{ad:{title:t,price:r,brand:n,model:a,modelYear:l,location:i,ownerName:s}}=e;return{titre_annonce:t,prix:r?`${r.toLocaleString("fr-FR")} €`:"",marque:n?.name||"",modele:a||"",annee:l?.toString()||"",ville:i.name,vendeur_nom:s}}(r),n=`Bonjour, je suis int\xe9ress\xe9 par votre annonce "${r.ad.title}".`,a=e?(0,tI.renderMessageTemplate)(e.content||n,t):n,l=(0,tI.generateWhatsAppLink)(r.ad.phoneNumber,a);await tA(r.id,a,e?.id),window.open(l,"_blank")}catch(e){console.error("Failed to send WhatsApp message:",e),alert("Erreur lors de l'envoi du message WhatsApp")}finally{d(!1)}}},p=async e=>{if(r)try{await tE(r.id,e.content),l(),u.reset()}catch(e){u.setError("root",{message:e instanceof Error?e.message:"Failed to add note"})}},x=async e=>{if(r)try{await tL(r.id,e.dueAt,e.note),l(),h.reset()}catch(e){h.setError("root",{message:e instanceof Error?e.message:"Failed to add reminder"})}},b=async e=>{if(!r)return;let t={...r,reminders:r.reminders.filter(t=>t.id!==e)};l(t,{revalidate:!1,optimisticData:t});try{await tT(e),l()}catch(e){console.error("Failed to delete reminder:",e),l()}};if(!e)return null;let v=r?.ad.picture?[r.ad.picture]:[],w=v.length>0;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:`fixed inset-0 z-40 bg-black/80 backdrop-blur-sm transition-opacity duration-300 ${e?"opacity-100":"pointer-events-none opacity-0"}`,onClick:t}),(0,y.jsxs)("aside",{className:`fixed right-0 top-0 z-50 h-full w-full max-w-2xl transform bg-zinc-950 shadow-2xl transition-transform duration-500 ease-out ${e?"translate-x-0":"translate-x-full"}`,children:[(0,y.jsxs)("header",{className:"sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800/50 bg-zinc-950/95 px-6 py-4 backdrop-blur-xl",children:[(0,y.jsx)("h2",{className:"text-lg font-semibold text-zinc-100",children:"Détails du lead"}),(0,y.jsx)("button",{onClick:t,className:"group rounded-lg p-2 transition-colors hover:bg-zinc-900","aria-label":"Fermer",children:(0,y.jsx)("svg",{className:"h-5 w-5 text-zinc-400 transition-colors group-hover:text-zinc-100",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,y.jsxs)("div",{className:"h-[calc(100vh-73px)] overflow-y-auto",children:[a&&(0,y.jsx)(rm,{}),n&&(0,y.jsx)("div",{className:"flex h-full items-center justify-center px-6",children:(0,y.jsx)("div",{className:"rounded-lg border border-red-900/50 bg-red-950/30 p-4 text-center",children:(0,y.jsx)("p",{className:"text-sm text-red-400",children:n instanceof Error?n.message:"Failed to load lead"})})}),r&&!a&&(0,y.jsxs)("div",{className:"space-y-6 p-6",children:[w&&(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsxs)("div",{className:"relative aspect-video overflow-hidden rounded-xl border border-zinc-800/50 bg-zinc-900",children:[(0,y.jsx)(tz.default,{src:v[s],alt:r.ad.title,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, 50vw",priority:!0}),(0,y.jsxs)("div",{className:"absolute right-3 top-3 rounded-lg bg-black/70 px-3 py-1.5 text-xs font-medium text-white backdrop-blur-sm",children:[s+1," / ",v.length]})]}),v.length>1&&(0,y.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-2",children:v.map((e,t)=>(0,y.jsx)("button",{onClick:()=>o(t),className:`relative h-16 w-24 flex-shrink-0 overflow-hidden rounded-lg border-2 transition-all ${t===s?"border-amber-500 ring-2 ring-amber-500/20":"border-zinc-800 hover:border-zinc-700"}`,children:(0,y.jsx)(tz.default,{src:e,alt:`Photo ${t+1}`,fill:!0,className:"object-cover",sizes:"96px"})},t))})]}),(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsx)("h3",{className:"text-xl font-semibold leading-tight text-zinc-100",children:r.ad.title}),(0,y.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-sm",children:[(0,y.jsx)("div",{className:"flex items-center gap-2",children:(0,y.jsxs)("span",{className:"text-2xl font-bold text-amber-500",children:[r.ad.price?.toLocaleString("fr-FR")," €"]})}),(0,y.jsxs)("div",{className:"flex items-center gap-1.5 text-zinc-400",children:[(0,y.jsxs)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,y.jsxs)("span",{children:[r.ad.location.name," (",r.ad.location.zipcode,")"]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-1.5 text-zinc-400",children:[(0,y.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,y.jsxs)("span",{children:["Publié"," ",(0,rc.formatDistance)(new Date(r.ad.lastPublicationDate),new Date,{addSuffix:!0,locale:rd.fr})]})]})]})]}),(0,y.jsxs)("section",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsx)(tB,{label:"Statut",value:r.stage,onChange:f,options:C.map(e=>({value:e,label:M(e).label,color:M(e).color})),placeholder:"Sélectionner un statut"}),(0,y.jsx)(tB,{label:"Assigné à",value:r.assignedTo?.id||null,onChange:m,options:i.map(e=>({value:e.id,label:e.name})),placeholder:"Non assigné",allowNull:!0,nullLabel:"Non assigné"})]}),(0,y.jsxs)("section",{className:"grid grid-cols-2 gap-3",children:[(0,y.jsxs)("button",{type:"button",onClick:g,disabled:!r.ad.phoneNumber||c,className:`group flex items-center justify-center gap-2 rounded-lg border px-4 py-3 font-medium transition-all ${!r.ad.phoneNumber?"cursor-not-allowed border-zinc-800 bg-zinc-900/50 text-zinc-600":"border-green-900/50 bg-green-950/30 text-green-400 hover:border-green-800 hover:bg-green-900/40"}`,title:r.ad.phoneNumber?"":"Numéro de téléphone non disponible",children:[c?(0,y.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-green-400 border-t-transparent"}):(0,y.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,y.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})}),(0,y.jsx)("span",{children:"WhatsApp"})]}),(0,y.jsxs)("button",{type:"button",disabled:!0,className:"group flex cursor-not-allowed items-center justify-center gap-2 rounded-lg border border-zinc-800 bg-zinc-900/50 px-4 py-3 font-medium text-zinc-600 transition-all",title:"Nécessite des crédits SMS",children:[(0,y.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),(0,y.jsx)("span",{children:"SMS"})]}),(0,y.jsxs)("button",{type:"button",disabled:!0,className:"group flex cursor-not-allowed items-center justify-center gap-2 rounded-lg border border-zinc-800 bg-zinc-900/50 px-4 py-3 font-medium text-zinc-600 transition-all",title:"Nécessite des crédits Voice",children:[(0,y.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),(0,y.jsx)("span",{children:"Voice"})]}),r.ad.url&&(0,y.jsxs)("a",{href:r.ad.url,target:"_blank",rel:"noopener noreferrer",className:"group flex items-center justify-center gap-2 rounded-lg border border-zinc-700/50 bg-zinc-800/30 px-4 py-3 font-medium text-zinc-400 transition-all hover:border-zinc-600 hover:bg-zinc-800/50 hover:text-zinc-300",children:[(0,y.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),(0,y.jsx)("span",{children:"Voir l'annonce"})]})]}),(r.ad.brand||r.ad.fuel||r.ad.gearBox||r.ad.modelYear)&&(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsx)("h4",{className:"text-sm font-semibold uppercase tracking-wider text-zinc-500",children:"Caractéristiques"}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[r.ad.brand&&(0,y.jsxs)("div",{className:"rounded-lg border border-zinc-800/50 bg-zinc-900/50 p-3",children:[(0,y.jsx)("div",{className:"text-xs text-zinc-500",children:"Marque"}),(0,y.jsx)("div",{className:"mt-1 font-medium text-zinc-200",children:r.ad.brand.name})]}),r.ad.model&&(0,y.jsxs)("div",{className:"rounded-lg border border-zinc-800/50 bg-zinc-900/50 p-3",children:[(0,y.jsx)("div",{className:"text-xs text-zinc-500",children:"Modèle"}),(0,y.jsx)("div",{className:"mt-1 font-medium text-zinc-200",children:r.ad.model})]}),r.ad.modelYear&&(0,y.jsxs)("div",{className:"rounded-lg border border-zinc-800/50 bg-zinc-900/50 p-3",children:[(0,y.jsx)("div",{className:"text-xs text-zinc-500",children:"Année"}),(0,y.jsx)("div",{className:"mt-1 font-medium text-zinc-200",children:r.ad.modelYear})]}),r.ad.mileage&&(0,y.jsxs)("div",{className:"rounded-lg border border-zinc-800/50 bg-zinc-900/50 p-3",children:[(0,y.jsx)("div",{className:"text-xs text-zinc-500",children:"Kilométrage"}),(0,y.jsxs)("div",{className:"mt-1 font-medium text-zinc-200",children:[r.ad.mileage.toLocaleString("fr-FR")," km"]})]}),r.ad.fuel&&(0,y.jsxs)("div",{className:"rounded-lg border border-zinc-800/50 bg-zinc-900/50 p-3",children:[(0,y.jsx)("div",{className:"text-xs text-zinc-500",children:"Carburant"}),(0,y.jsx)("div",{className:"mt-1 font-medium text-zinc-200",children:r.ad.fuel.name})]}),r.ad.gearBox&&(0,y.jsxs)("div",{className:"rounded-lg border border-zinc-800/50 bg-zinc-900/50 p-3",children:[(0,y.jsx)("div",{className:"text-xs text-zinc-500",children:"Boîte"}),(0,y.jsx)("div",{className:"mt-1 font-medium text-zinc-200",children:r.ad.gearBox.name})]})]})]}),(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsx)("h4",{className:"text-sm font-semibold uppercase tracking-wider text-zinc-500",children:"Vendeur"}),(0,y.jsx)("div",{className:"rounded-lg border border-zinc-800/50 bg-zinc-900/50 p-4",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{className:"font-medium text-zinc-200",children:r.ad.ownerName}),r.ad.phoneNumber&&(0,y.jsx)("div",{className:"mt-1 text-sm text-zinc-400",children:r.ad.phoneNumber})]}),(0,y.jsx)("div",{className:`rounded-full px-3 py-1 text-xs font-medium ${r.ad.acceptSalesmen?"bg-blue-900/30 text-blue-400":"bg-purple-900/30 text-purple-400"}`,children:r.ad.acceptSalesmen?"Pro":"Particulier"})]})})]}),(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsx)("h4",{className:"text-sm font-semibold uppercase tracking-wider text-zinc-500",children:"Notes"}),(0,y.jsx)(tW.Form,{...u,children:(0,y.jsxs)("form",{onSubmit:u.handleSubmit(p),className:"space-y-2",children:[(0,y.jsx)(tW.FormField,{control:u.control,name:"content",render:({field:e})=>(0,y.jsxs)(tW.FormItem,{children:[(0,y.jsx)(tW.FormControl,{children:(0,y.jsx)("textarea",{...e,placeholder:"Ajouter une note...",rows:3,className:"w-full rounded-lg border border-zinc-800 bg-zinc-900/50 px-3 py-2 text-sm text-zinc-200 placeholder-zinc-500 focus:border-amber-500 focus:outline-none focus:ring-1 focus:ring-amber-500"})}),(0,y.jsx)(tW.FormMessage,{})]})}),u.formState.errors.root&&(0,y.jsx)("p",{className:"text-xs text-red-400",children:u.formState.errors.root.message}),(0,y.jsx)("button",{type:"submit",disabled:u.formState.isSubmitting,className:"rounded-lg bg-amber-500 px-4 py-2 text-sm font-medium text-black transition-colors hover:bg-amber-400 disabled:cursor-not-allowed disabled:opacity-50",children:u.formState.isSubmitting?"Enregistrement...":"Sauvegarder"})]})}),r.notes&&r.notes.length>0&&(0,y.jsx)("div",{className:"space-y-2",children:r.notes.map(e=>(0,y.jsxs)("div",{className:"rounded-lg border border-zinc-800/50 bg-zinc-900/50 p-3",children:[(0,y.jsx)("p",{className:"text-sm text-zinc-300",children:e.content}),(0,y.jsx)("div",{className:"mt-2 text-xs text-zinc-500",children:(0,y.jsx)("span",{children:(0,rc.formatDistance)(new Date(e.createdAt),new Date,{addSuffix:!0,locale:rd.fr})})})]},e.id))})]}),(0,y.jsxs)("section",{className:"space-y-3",children:[(0,y.jsx)("h4",{className:"text-sm font-semibold uppercase tracking-wider text-zinc-500",children:"Rappels"}),(0,y.jsx)(tW.Form,{...h,children:(0,y.jsxs)("form",{onSubmit:h.handleSubmit(x),className:"space-y-2",children:[(0,y.jsx)(tW.FormField,{control:h.control,name:"dueAt",render:({field:e})=>(0,y.jsxs)(tW.FormItem,{children:[(0,y.jsx)(tW.FormLabel,{className:"text-xs text-zinc-400",children:"Date et heure"}),(0,y.jsx)(tW.FormControl,{children:(0,y.jsx)("input",{type:"datetime-local",value:e.value instanceof Date?e.value.toISOString().slice(0,16):"",onChange:t=>e.onChange(new Date(t.target.value)),className:"w-full rounded-lg border border-zinc-800 bg-zinc-900/50 px-3 py-2 text-sm text-zinc-200 focus:border-amber-500 focus:outline-none focus:ring-1 focus:ring-amber-500"})}),(0,y.jsx)(tW.FormMessage,{})]})}),(0,y.jsx)(tW.FormField,{control:h.control,name:"note",render:({field:e})=>(0,y.jsxs)(tW.FormItem,{children:[(0,y.jsx)(tW.FormLabel,{className:"text-xs text-zinc-400",children:"Note (optionnel)"}),(0,y.jsx)(tW.FormControl,{children:(0,y.jsx)("textarea",{...e,placeholder:"Note pour le rappel...",rows:2,className:"w-full rounded-lg border border-zinc-800 bg-zinc-900/50 px-3 py-2 text-sm text-zinc-200 placeholder-zinc-500 focus:border-amber-500 focus:outline-none focus:ring-1 focus:ring-amber-500"})}),(0,y.jsx)(tW.FormMessage,{})]})}),h.formState.errors.root&&(0,y.jsx)("p",{className:"text-xs text-red-400",children:h.formState.errors.root.message}),(0,y.jsx)("button",{type:"submit",disabled:h.formState.isSubmitting,className:"rounded-lg bg-amber-500 px-4 py-2 text-sm font-medium text-black transition-colors hover:bg-amber-400 disabled:cursor-not-allowed disabled:opacity-50",children:h.formState.isSubmitting?"Ajout...":"Ajouter"})]})}),r.reminders&&r.reminders.length>0&&(0,y.jsx)("div",{className:"space-y-2",children:r.reminders.map(e=>(0,y.jsxs)("div",{className:"flex items-start justify-between rounded-lg border border-zinc-800/50 bg-zinc-900/50 p-3",children:[(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-zinc-200",children:[(0,y.jsx)("svg",{className:"h-4 w-4 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,y.jsx)("span",{children:function(e,t,r){let n=(0,t$.getDefaultOptions)(),a=r?.locale??n.locale??tq.defaultLocale,l=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,i=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,s=(0,tV.toDate)(e,r?.in);if(!(s instanceof Date||"object"==typeof s&&"[object Date]"===Object.prototype.toString.call(s))&&"number"!=typeof s||isNaN(+(0,tV.toDate)(s)))throw RangeError("Invalid time value");let o=t.match(rl).map(e=>{let t=e[0];return"p"===t||"P"===t?(0,re[t])(e,a.formatLong):e}).join("").match(ra).map(e=>{if("''"===e)return{isToken:!1,value:"'"};let t=e[0];if("'"===t){var r;let t;return{isToken:!1,value:(t=(r=e).match(ri))?t[1].replace(rs,"'"):r}}if(t5[t])return{isToken:!0,value:e};if(t.match(ro))throw RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});a.localize.preprocessor&&(o=a.localize.preprocessor(s,o));let c={firstWeekContainsDate:l,weekStartsOn:i,locale:a};return o.map(n=>{if(!n.isToken)return n.value;let l=n.value;return(!r?.useAdditionalWeekYearTokens&&rr.test(l)||!r?.useAdditionalDayOfYearTokens&&rt.test(l))&&function(e,t,r){var n,a,l;let i,s=(n=e,a=t,l=r,i="Y"===n[0]?"years":"days of the month",`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${a}\`) for formatting ${i} to the input \`${l}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`);if(console.warn(s),rn.includes(e))throw RangeError(s)}(l,t,String(e)),(0,t5[l[0]])(s,l,a.localize,c)}).join("")}(new Date(e.dueAt),"dd MMM yyyy, HH:mm",{locale:rd.fr})})]}),e.note&&(0,y.jsx)("p",{className:"mt-1 text-sm text-zinc-400",children:e.note}),(0,y.jsx)("p",{className:"mt-1 text-xs text-zinc-500",children:(0,rc.formatDistance)(new Date(e.dueAt),new Date,{addSuffix:!0,locale:rd.fr})})]}),(0,y.jsx)("button",{type:"button",onClick:()=>b(e.id),className:"ml-2 rounded p-1 text-zinc-500 transition-colors hover:bg-zinc-800 hover:text-red-400","aria-label":"Supprimer le rappel",children:(0,y.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},e.id))})]}),(0,y.jsx)("a",{href:tY.pages.leads.detail(r.id),className:"block w-full rounded-lg border border-amber-900/50 bg-amber-950/30 px-4 py-3 text-center font-medium text-amber-400 transition-all hover:border-amber-800 hover:bg-amber-900/40",children:"Voir détails complets"})]})]})]})]})}function rp({initialLeads:e}){let[t,r]=(0,L.useState)(null),[n,a]=(0,L.useState)(null),[l,i]=(0,L.useTransition)(),[s,o]=(0,L.useState)(!1),{data:c=e,mutate:d}=(0,tk.default)(S.swrKeys.leads.pipeline,()=>N(),{fallbackData:e,refreshInterval:s?0:z.SWR_POLLING.KANBAN,revalidateOnFocus:!0}),u=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,L.useMemo)(()=>[...t].filter(e=>null!=e),[...t])}(ed(eK),ed(eH)),h=t?c.find(e=>e.id===t):null;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(to,{sensors:u,collisionDetection:eg,onDragStart:e=>{o(!0),r(e.active.id)},onDragEnd:e=>{o(!1);let{active:t,over:n}=e;if(!n)return void r(null);let a=t.id,l=n.id,s=c.map(e=>e.id===a?{...e,stage:l}:e);d(s,{revalidate:!1,optimisticData:s}),i(async()=>{try{await k(a,l),d()}catch(e){console.error("Failed to update lead stage:",e),d()}}),r(null)},onDragCancel:()=>{o(!1),r(null)},children:[(0,y.jsx)("div",{className:"flex h-full gap-4 overflow-x-auto pb-4",children:D.map(e=>{let r=c.filter(t=>t.stage===e.value);return(0,y.jsx)(tS,{id:e.value,title:e.label,count:r.length,children:(0,y.jsx)(tN,{items:r.map(e=>e.id),children:(0,y.jsxs)("div",{className:"space-y-3",children:[r.map(e=>(0,y.jsx)(tM,{lead:e,onClick:()=>a(e.id),isDragging:e.id===t},e.id)),0===r.length&&(0,y.jsx)("p",{className:"py-8 text-center text-sm text-zinc-600",children:"Aucun lead"})]})})},e.value)})}),(0,y.jsx)(tv,{children:h?(0,y.jsx)(tM,{lead:h,isDragging:!0}):null})]}),(0,y.jsx)(rg,{leadId:n,onClose:()=>a(null)})]})}var rx=e.i(29822);function rb(){let e=(0,rx.useRouter)(),t=(0,rx.usePathname)(),r=(0,rx.useSearchParams)(),n=(0,L.useCallback)((e,t)=>{let n=new URLSearchParams(r.toString());return t?n.set(e,t):n.delete(e),n.toString()},[r]),a=(r,a)=>{let l=n(r,a);e.push(`${t}?${l}`,{scroll:!1})};return(0,y.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,y.jsx)("select",{className:"rounded-lg border border-zinc-800 bg-zinc-900 px-3 py-2 text-sm text-zinc-100 focus:border-amber-500 focus:outline-none focus:ring-1 focus:ring-amber-500",value:r.get("hunt")||"",onChange:e=>a("hunt",e.target.value),children:(0,y.jsx)("option",{value:"",children:"Toutes les recherches"})}),(0,y.jsxs)("select",{className:"rounded-lg border border-zinc-800 bg-zinc-900 px-3 py-2 text-sm text-zinc-100 focus:border-amber-500 focus:outline-none focus:ring-1 focus:ring-amber-500",value:r.get("assigned")||"",onChange:e=>a("assigned",e.target.value),children:[(0,y.jsx)("option",{value:"",children:"Tous les utilisateurs"}),(0,y.jsx)("option",{value:"me",children:"Mes leads"}),(0,y.jsx)("option",{value:"unassigned",children:"Non assignés"})]}),(0,y.jsx)("input",{type:"search",placeholder:"Rechercher...",className:"min-w-[200px] rounded-lg border border-zinc-800 bg-zinc-900 px-3 py-2 text-sm text-zinc-100 placeholder-zinc-500 focus:border-amber-500 focus:outline-none focus:ring-1 focus:ring-amber-500",value:r.get("q")||"",onChange:e=>a("q",e.target.value)}),(r.get("hunt")||r.get("assigned")||r.get("q"))&&(0,y.jsx)("button",{onClick:()=>e.push(t),className:"rounded-lg border border-zinc-800 bg-zinc-900 px-3 py-2 text-sm text-zinc-400 hover:bg-zinc-800 hover:text-zinc-100",children:"Réinitialiser"})]})}function rv({leads:e}){let[t,r]=(0,L.useState)("kanban");return(0,y.jsxs)("div",{className:"flex h-full flex-col",children:[(0,y.jsxs)("div",{className:"border-b border-zinc-800 bg-zinc-950 p-4",children:[(0,y.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,y.jsx)("h1",{className:"text-2xl font-semibold text-zinc-100",children:"Pipeline de leads"}),(0,y.jsxs)("div",{className:"inline-flex rounded-lg border border-zinc-800 bg-zinc-900 p-1",children:[(0,y.jsx)("button",{onClick:()=>r("kanban"),className:`rounded-md px-4 py-2 text-sm font-medium transition-colors ${"kanban"===t?"bg-amber-500 text-zinc-950":"text-zinc-400 hover:text-zinc-100"}`,children:"Kanban"}),(0,y.jsx)("button",{onClick:()=>r("list"),className:`rounded-md px-4 py-2 text-sm font-medium transition-colors ${"list"===t?"bg-amber-500 text-zinc-950":"text-zinc-400 hover:text-zinc-100"}`,children:"Liste"})]})]}),(0,y.jsx)(rb,{})]}),(0,y.jsx)("div",{className:"flex-1 overflow-auto bg-zinc-950 p-4",children:"kanban"===t?(0,y.jsx)(rp,{initialLeads:e}):(0,y.jsx)("div",{className:"h-full",children:(0,y.jsx)("p",{className:"text-center text-zinc-400",children:"List view coming soon."})})})]})}e.s(["LeadsPageClient",()=>rv],18116)}]);